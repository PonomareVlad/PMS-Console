{"version":3,"sources":["webpack:///init.js","webpack:///webpack/bootstrap 962b6b41123f3c54641c","webpack:///./assets/js/workspace.js","webpack:///./assets/js/init.js","webpack:///./assets/js/auth.js"],"names":["modules","__webpack_require__","moduleId","installedModules","exports","module","i","l","call","m","c","d","name","getter","o","Object","defineProperty","configurable","enumerable","get","n","__esModule","object","property","prototype","hasOwnProperty","p","s","init","pms","workspace","onLeavePage","appearance","loadIndicators","progressState","window","addEventListener","onFirstTouch","document","body","classList","toggle","removeEventListener","test","navigator","userAgent","MSStream","iOS","standalone","toLowerCase","indexOf","macOs","require","script","io","then","response","eval","apply","e","console","error","prepare","initHistoryHandler","bind","this","showLoadingIndicator","template","wrapper","updateHostsData","render","loadHost","renderHostsSelectMenu","loadNotifications","hideLoadingIndicator","loadTemplate","alert","event","state","type","leavePage","querySelector","innerHTML","history","pushState","prepareWrapper","selectedHost","title","getElementById","innerText","logo","src","homePage","href","currentHost","selectHost","value","toggleMobileMenu","userName","userData","firstname","lastname","login","avamoji","menu","notificationsWrapper","id","html","node","arguments","length","undefined","Promise","resolve","reject","status","hostsData","domainsHost","domain","outputSource","hostsDataKeys","keys","host","menuNode","parentNode","style","display","loadMenu","getHostModules","hostId","menuStructure","modulesData","moduleData","push","getModuleData","loadModule","loaded","menuSource","menu_item_title","description","menuItemClick","itemId","parameters","isProgress","setProgress","showItemLoadIndicator","workspaceGenerator","catch","errorHandler","result","hideItemLoadIndicator","menuItemsWorker","menuItems","renderMenuItems","menu_item_type","_typeof","debug","statusText","attribute","item","querySelectorAll","loader","setTimeout","recursion","removeChild","cursor","menuId","items","container","JSON","stringify","getHostUrl","excludePath","hostData","https","path","notifications","notification","renderNotifications","notificationsSource","icon","time","actions","action","notifyAction","notificationId","actionId","method","closeAfter","removeNotification","local","parseInt","splice","createNotification","Date","getTime","data","showNotification","notificationSource","message","close","report","errorReport","config","stack","initPromise","importModule","Symbol","iterator","obj","constructor","onerror","url","lineNumber","_require","_interopRequireWildcard","newObj","key","default","initApp","pmsHostData","auth","check","showLogin","oldIo","post","plainData","apiUrl","map","k","encodeURIComponent","join","token","localStorage","getItem","mode","credentials","fetch","text","json","debugData","decodeURIComponent","offline","initOfflineMode","getData","postData","serialize","getCookie","prefix","str","v","matches","cookie","match","RegExp","replace","_workspace","_auth","isFramed","top","self","location","initTimeout","clearTimeout","parent","postMessage","saveUserData","send","password","loginError","authLogin","loginMessage","authPassword","passwordMessage","loginSection","log","prepareLogin","setItem","userId","email","OneSignal","appId","autoRegister","notifyButton","enable","promptOptions","actionMessage","acceptButtonText","cancelButtonText","logout","clear"],"mappings":"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","file":"init.js","sourcesContent":["/******/ (function(modules) { // webpackBootstrap\n/******/ \t// The module cache\n/******/ \tvar installedModules = {};\n/******/\n/******/ \t// The require function\n/******/ \tfunction __webpack_require__(moduleId) {\n/******/\n/******/ \t\t// Check if module is in cache\n/******/ \t\tif(installedModules[moduleId]) {\n/******/ \t\t\treturn installedModules[moduleId].exports;\n/******/ \t\t}\n/******/ \t\t// Create a new module (and put it into the cache)\n/******/ \t\tvar module = installedModules[moduleId] = {\n/******/ \t\t\ti: moduleId,\n/******/ \t\t\tl: false,\n/******/ \t\t\texports: {}\n/******/ \t\t};\n/******/\n/******/ \t\t// Execute the module function\n/******/ \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n/******/\n/******/ \t\t// Flag the module as loaded\n/******/ \t\tmodule.l = true;\n/******/\n/******/ \t\t// Return the exports of the module\n/******/ \t\treturn module.exports;\n/******/ \t}\n/******/\n/******/\n/******/ \t// expose the modules object (__webpack_modules__)\n/******/ \t__webpack_require__.m = modules;\n/******/\n/******/ \t// expose the module cache\n/******/ \t__webpack_require__.c = installedModules;\n/******/\n/******/ \t// define getter function for harmony exports\n/******/ \t__webpack_require__.d = function(exports, name, getter) {\n/******/ \t\tif(!__webpack_require__.o(exports, name)) {\n/******/ \t\t\tObject.defineProperty(exports, name, {\n/******/ \t\t\t\tconfigurable: false,\n/******/ \t\t\t\tenumerable: true,\n/******/ \t\t\t\tget: getter\n/******/ \t\t\t});\n/******/ \t\t}\n/******/ \t};\n/******/\n/******/ \t// getDefaultExport function for compatibility with non-harmony modules\n/******/ \t__webpack_require__.n = function(module) {\n/******/ \t\tvar getter = module && module.__esModule ?\n/******/ \t\t\tfunction getDefault() { return module['default']; } :\n/******/ \t\t\tfunction getModuleExports() { return module; };\n/******/ \t\t__webpack_require__.d(getter, 'a', getter);\n/******/ \t\treturn getter;\n/******/ \t};\n/******/\n/******/ \t// Object.prototype.hasOwnProperty.call\n/******/ \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n/******/\n/******/ \t// __webpack_public_path__\n/******/ \t__webpack_require__.p = \"/pms-console/\";\n/******/\n/******/ \t// Load entry module and return exports\n/******/ \treturn __webpack_require__(__webpack_require__.s = 1);\n/******/ })\n/************************************************************************/\n/******/ ([\n/* 0 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _typeof = typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; };\n\nexports.init = init;\nexports.prepare = prepare;\nexports.loadTemplate = loadTemplate;\nexports.render = render;\nexports.updateHostsData = updateHostsData;\nexports.renderHostsSelectMenu = renderHostsSelectMenu;\nexports.loadHost = loadHost;\nexports.getHostModules = getHostModules;\nexports.getModuleData = getModuleData;\nexports.loadModule = loadModule;\nexports.loadMenu = loadMenu;\nexports.menuItemClick = menuItemClick;\nexports.showItemLoadIndicator = showItemLoadIndicator;\nexports.hideItemLoadIndicator = hideItemLoadIndicator;\nexports.showLoadingIndicator = showLoadingIndicator;\nexports.hideLoadingIndicator = hideLoadingIndicator;\nexports.leavePage = leavePage;\nexports.selectHost = selectHost;\nexports.isProgress = isProgress;\nexports.setProgress = setProgress;\nexports.renderMenuItems = renderMenuItems;\nexports.getHostUrl = getHostUrl;\nexports.loadNotifications = loadNotifications;\nexports.renderNotifications = renderNotifications;\nexports.notifyAction = notifyAction;\nexports.removeNotification = removeNotification;\nexports.createNotification = createNotification;\nexports.showNotification = showNotification;\nexports.errorHandler = errorHandler;\nexports.initPromise = initPromise;\nexports.importModule = importModule;\nvar template = {};\n\nwindow.menuItemClick = menuItemClick;\nwindow.workspace = { render: render, loadTemplate: loadTemplate, require: _require, leavePage: leavePage, init: init };\nwindow.showLoadingIndicator = showLoadingIndicator;\nwindow.hideLoadingIndicator = hideLoadingIndicator;\nwindow.showItemLoadIndicator = showItemLoadIndicator;\nwindow.hideItemLoadIndicator = hideItemLoadIndicator;\nwindow.selectHost = selectHost;\nwindow.isProgress = isProgress;\nwindow.setProgress = setProgress;\nwindow.getHostUrl = getHostUrl;\nwindow.notifyAction = notifyAction;\nwindow.createNotification = createNotification;\nwindow.showNotification = showNotification;\nwindow.errorHandler = errorHandler;\nwindow.initPromise = initPromise;\nwindow.importModule = importModule;\n\nwindow.onerror = function (message, url, lineNumber) {\n    return errorHandler(arguments, message);\n    /*alert(\"Поймана ошибка, выпавшая в глобальную область!\\n\" +\n        \"Сообщение: \" + message + \"\\n(\" + url + \":\" + lineNumber + \")\");*/\n};\n\nfunction init() {\n    if (!pms.workspace) pms.workspace = {};\n    if (!pms.onLeavePage) pms.onLeavePage = [];\n    if (!pms.appearance) pms.appearance = {};\n    if (!pms.appearance.loadIndicators) pms.appearance.loadIndicators = {};\n    if (!pms.progressState) pms.progressState = {};\n\n    window.addEventListener('touchstart', function onFirstTouch() {\n        document.body.classList.toggle('touchscreen', true);\n        window.removeEventListener('touchstart', onFirstTouch, false);\n    }, false);\n\n    if (/iPad|iPhone|iPod/.test(navigator.userAgent) && !window.MSStream) {\n        pms.workspace.iOS = true;\n        if (\"standalone\" in window.navigator && window.navigator.standalone) document.body.classList.toggle('ios-standalone', true);\n    } else if (navigator.userAgent.toLowerCase().indexOf('safari') !== -1 && navigator.userAgent.toLowerCase().indexOf('chrome') < 0) {\n        pms.workspace.macOs = true;\n    } else {\n        document.body.classList.toggle('material', true);\n    }\n}\n\nfunction _require(script) {\n    return io(false, false, false, './assets/js/' + script + '.js', true).then(function (response) {\n        if (!response) return false;\n        try {\n            eval.apply(window, [response]);\n        } catch (e) {\n            console.error(e);\n            return false;\n        }\n        return true;\n    });\n}\n\nexports.require = _require;\nfunction prepare() {\n    init();\n    initHistoryHandler.bind(this)();\n    showLoadingIndicator();\n    if (!template.wrapper) return loadTemplate('wrapper').then(function (response) {\n        if (!response) {\n            alert('Не удалось загрузить страницу');\n            return false;\n        }\n        return template.wrapper = response;\n    })\n    // .then(prepareWrapper)\n    .then(updateHostsData).then(function () {\n        return render(template.wrapper);\n    }).then(loadHost).then(renderHostsSelectMenu).then(loadNotifications).then(hideLoadingIndicator);else return updateHostsData().then(function () {\n        return render(template.wrapper);\n    }).then(loadHost).then(renderHostsSelectMenu).then(loadNotifications).then(hideLoadingIndicator);\n}\n\nfunction initHistoryHandler() {\n    window.addEventListener('popstate', function (event) {\n        if (event.state && event.state.type && event.state.type === 'workspace') {\n            leavePage();\n            document.querySelector('#workspace-wrapper').innerHTML = '<div class=\"flex-center center-text\">\\n            <div><h3 class=\"slim-title\">\\u0414\\u043E\\u0431\\u0440\\u043E \\u043F\\u043E\\u0436\\u0430\\u043B\\u043E\\u0432\\u0430\\u0442\\u044C!</h3><br>\\n                <h3 class=\"slim-subtitle\">\\u0414\\u043B\\u044F \\u043D\\u0430\\u0447\\u0430\\u043B\\u0430, \\u0432\\u044B\\u0431\\u0435\\u0440\\u0438\\u0442\\u0435 \\u043D\\u0435\\u043E\\u0431\\u0445\\u043E\\u0434\\u0438\\u043C\\u044B\\u0439 \\u0440\\u0430\\u0437\\u0434\\u0435\\u043B \\u0432 <span\\n                        class=\"hide-on-mobile\">\\u0431\\u043E\\u043A\\u043E\\u0432\\u043E\\u043C</span><span class=\"hide-on-desktop\">\\u0432\\u0435\\u0440\\u0445\\u043D\\u0435\\u043C</span> \\u041C\\u0435\\u043D\\u044E</h3>\\n            </div>\\n        </div>';\n        }\n    }.bind(this));\n    history.pushState({ type: 'workspace' }, \"Панель управления Cotton Baby\");\n}\n\nfunction prepareWrapper() {\n    if (pms.selectedHost) {\n        if (pms.selectedHost.title && document.getElementById('host-name')) document.getElementById('host-name').innerText = pms.selectedHost.title;\n        if (pms.selectedHost.logo && document.getElementById('host-logo')) document.getElementById('host-logo').src = pms.selectedHost.logo;\n        if (pms.selectedHost.homePage && document.getElementById('home-page')) document.getElementById('home-page').href = pms.selectedHost.homePage;\n    } else if (pms.currentHost) {\n        if (pms.currentHost.title && document.getElementById('host-name')) document.getElementById('host-name').innerText = pms.currentHost.title;\n        if (pms.currentHost.logo && document.getElementById('host-logo')) document.getElementById('host-logo').src = pms.currentHost.logo;\n        if (pms.currentHost.homePage && document.getElementById('home-page')) document.getElementById('home-page').href = pms.currentHost.homePage;\n    }\n    if (document.getElementById('select-hosts-menu')) document.getElementById('select-hosts-menu').addEventListener('change', function () {\n        selectHost(this.value);\n    });\n    if (document.getElementById('header-menu-button')) document.getElementById('header-menu-button').addEventListener('click', toggleMobileMenu);\n    var userName = pms.userData.firstname ? pms.userData.firstname + (pms.userData.lastname ? ' ' + pms.userData.lastname : '') : pms.userData.login ? pms.userData.login : 'Любимый пользователь';\n    if (document.getElementById('user-name')) document.getElementById('user-name').innerText = userName;\n    if (pms.userData.avamoji && document.getElementById('user-avamoji')) document.getElementById('user-avamoji').innerText = pms.userData.avamoji;\n    if (document.getElementById('workspace-menu')) pms.workspace.menu = document.getElementById('workspace-menu');\n    if (document.getElementById('workspace-wrapper')) pms.workspace.wrapper = document.getElementById('workspace-wrapper');\n    if (document.getElementById('notificationsWrapper')) {\n        pms.workspace.notificationsWrapper = document.getElementById('notificationsWrapper');\n    }\n    return true;\n}\n\nfunction loadTemplate(id) {\n    return io(false, false, false, './' + id + '.html', true).then(function (response) {\n        if (typeof response !== 'string') return false;else return response;\n    });\n}\n\nfunction render(html) {\n    var node = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : document.body;\n\n    init();\n    leavePage(); /// FUUUCK!!!!\n    return new Promise(function (resolve, reject) {\n        if (!html) return false;\n        node.innerHTML = html;\n        return resolve(node);\n    });\n}\n\nfunction updateHostsData() {\n    return io('console/getHosts').then(function (response) {\n        if (!response.status) return false;\n        if (response.hostsData) {\n            if (!pms.hostsData) pms.hostsData = {};\n            if (!pms.domainsHost) pms.domainsHost = {};\n            for (var i in response.hostsData) {\n                pms.hostsData[response.hostsData[i].id] = response.hostsData[i];\n                pms.domainsHost[response.hostsData[i].domain] = response.hostsData[i];\n            }\n        }\n        return true;\n    });\n}\n\nfunction renderHostsSelectMenu() {\n    var outputSource = '<option selected disabled>🌐 Выбрать Сайт</option>';\n    var hostsDataKeys = Object.keys(pms.hostsData);\n    for (var i in hostsDataKeys) {\n        var host = pms.hostsData[hostsDataKeys[i]];\n        var title = host.title ? host.title : host.domain;\n        //let active = pms.selectedHost ? (pms.selectedHost.id === host.id ? 'selected' : '') : '';\n        outputSource += '<option value=\"' + host.id + '\" ' + '>' + title + '</option>';\n    }\n    var menuNode = document.getElementById('select-hosts-menu');\n    menuNode.innerHTML = outputSource;\n    if (hostsDataKeys.length > 1) menuNode.parentNode.style.display = 'initial';else menuNode.parentNode.style.display = 'none';\n    return true;\n}\n\nfunction loadHost(id) {\n    leavePage();\n    return new Promise(function (resolve, reject) {\n        if (!pms.hostsData) return resolve(false);\n        if (!id || !(typeof id === \"string\" || typeof id === \"number\")) {\n            id = false;\n            if (pms.currentHost && pms.currentHost.domain) if (pms.domainsHost[pms.currentHost.domain]) id = pms.domainsHost[pms.currentHost.domain].id;\n            id = id ? id : Object.keys(pms.hostsData)[0];\n        }\n        var host = pms.selectedHost = pms.hostsData[id];\n        if (!host.modules) return resolve(getHostModules(host.id).then(function (response) {\n            if (!response) return response;\n            return host;\n        }).then(prepareWrapper).then(loadMenu));\n        return resolve(new Promise(function (resolve, reject) {\n            return resolve(prepareWrapper());\n        }).then(loadMenu));\n    });\n}\n\nfunction getHostModules(hostId) {\n    return io('console/getModules', { hostId: hostId }).then(function (response) {\n        if (!response.status) return false;\n        var host = pms.hostsData[hostId];\n        host.menuStructure = [];\n        if (!host.modules) host.modules = {};\n        for (var i in response.modulesData) {\n            var moduleData = response.modulesData[i];\n            if (!pms.module) pms.module = {};\n            if (!pms.module[moduleData.id]) pms.module[moduleData.id] = moduleData;\n            host.modules[moduleData.id] = pms.module[moduleData.id];\n            host.menuStructure.push(host.modules[moduleData.id]);\n        }\n        return true;\n    });\n}\n\nfunction getModuleData(moduleId) {\n    var hostId = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;\n\n    hostId = hostId ? hostId : pms.selectedHost.id;\n    // console.debug('getModuleData', moduleId, hostId);\n    return new Promise(function (resolve, reject) {\n        if (pms.hostsData[hostId].modules[moduleId].init) return resolve(moduleId);else return resolve(io('console/getModuleData', {\n            moduleId: moduleId,\n            hostId: hostId\n        }).then(function (response) {\n            if (!response.status || !response.init) return false;\n            var host = pms.hostsData[hostId];\n            host.modules[moduleId].init = response.init;\n            return moduleId;\n        }));\n    });\n}\n\nfunction loadModule(moduleId) {\n    return new Promise(function (resolve, reject) {\n        if (!pms.module[moduleId] || !pms.module[moduleId].init) return resolve(false);\n        if (pms.module[moduleId].loaded) return resolve(true);\n        try {\n            eval(pms.module[moduleId].init);\n        } catch (e) {\n            reject(e);\n        }\n        pms.module[moduleId].loaded = true;\n        return resolve(true);\n    });\n}\n\nfunction loadMenu() {\n    if (!pms.selectedHost || !pms.selectedHost.modules) return false;\n    var modules = pms.selectedHost.menuStructure ? pms.selectedHost.menuStructure : pms.selectedHost.modules;\n    var menuSource = '<h2>Меню:</h2><ul>';\n    for (var i in modules) {\n        var module = pms.module[modules[i].id];\n        var title = module.menu_item_title ? module.menu_item_title : module.title ? module.title : module.id;\n        var description = module.description ? '<p>' + module.description + '</p>' : '';\n        menuSource += '<li data-menu-item=\"' + module.id + '\" onclick=\"menuItemClick(\\'' + module.id + '\\')\"><a href=\"javascript:void(0);\"><span>' + title + '</span>' + description + '</a>' + '</li><ul data-menu-item-container=\"' + module.id + '\"></ul>';\n    }\n    menuSource += '</ul>';\n    if (pms.workspace.menu) pms.workspace.menu.innerHTML = menuSource;\n    return true;\n}\n\nfunction menuItemClick() {\n    var moduleId = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : false;\n    var itemId = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;\n    var parameters = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : false;\n    var type = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : false;\n\n    if (isProgress('menuItem')) return false;\n    setProgress('menuItem');\n    var module = pms.module[moduleId];\n    if (!itemId) itemId = moduleId;\n    showItemLoadIndicator(itemId, 'menu-item');\n    showLoadingIndicator();\n    if (!parameters) {\n        if (module.menu_item_type && module.menu_item_type === 'item') {\n            if (!module.loaded) getModuleData(moduleId).then(loadModule).catch(function (error) {\n                return false;\n            }).then(function (response) {\n                if (!response || !module.loaded) alert('Раздел временно недоступен');\n                if (module.workspaceGenerator) return module.workspaceGenerator();\n                return { status: true };\n            }).then(function (response) {\n                if ((typeof response === 'undefined' ? 'undefined' : _typeof(response)) !== 'object') return false;\n                if (!response.status) console.debug(moduleId, response.statusText ? response.statusText : response);\n                return true;\n            }).then(function (result) {\n                setProgress('menuItem', false);\n                hideLoadingIndicator();\n                hideItemLoadIndicator(itemId, 'menu-item');\n                toggleMobileMenu(false);\n                return result;\n            });else if (module.workspaceGenerator) return module.workspaceGenerator().then(function (result) {\n                setProgress('menuItem', false);\n                hideLoadingIndicator();\n                hideItemLoadIndicator(itemId, 'menu-item');\n                toggleMobileMenu(false);\n                return result;\n            });\n        } else if (module.menu_item_type && module.menu_item_type === 'group') {\n            if (!module.loaded) getModuleData(moduleId).then(loadModule).catch(function (error) {\n                return false;\n            }).then(function (response) {\n                if (!response || !module.loaded) alert('Раздел временно недоступен');\n                if (module.menuItemsWorker) return module.menuItemsWorker();\n                return { status: true };\n            }).then(function (response) {\n                // console.debug(response);\n                if ((typeof response === 'undefined' ? 'undefined' : _typeof(response)) !== 'object') return false;\n                if (!response.status) console.debug(moduleId, response.statusText ? response.statusText : response);\n                return response.menuItems ? renderMenuItems(moduleId, itemId, response.menuItems) : true;\n            }).then(function (result) {\n                setProgress('menuItem', false);\n                hideLoadingIndicator();\n                hideItemLoadIndicator(itemId, 'menu-item');\n                return result;\n            });else if (module.menuItemsWorker) return module.menuItemsWorker().then(function (response) {\n                console.debug(response);\n                if ((typeof response === 'undefined' ? 'undefined' : _typeof(response)) !== 'object') return false;\n                if (!response.status) console.debug(moduleId, response.statusText ? response.statusText : response);\n                return response.menuItems ? renderMenuItems(moduleId, itemId, response.menuItems) : true;\n            }).then(function (result) {\n                setProgress('menuItem', false);\n                hideLoadingIndicator();\n                hideItemLoadIndicator(itemId, 'menu-item');\n                return result;\n            });\n            setProgress('menuItem', false);\n            hideLoadingIndicator();\n            hideItemLoadIndicator(itemId, 'menu-item');\n        }\n    } else {\n        if (!type) {} else {\n            // console.debug(moduleId, parameters, type);\n            if (type === 'item') {\n                if (module.workspaceGenerator) return module.workspaceGenerator(parameters).catch(errorHandler).then(function (result) {\n                    setProgress('menuItem', false);\n                    hideLoadingIndicator();\n                    hideItemLoadIndicator(itemId, 'menu-item');\n                    toggleMobileMenu(false);\n                    return result;\n                });\n            } else if (type === 'group') {\n                if (module.menuItemsWorker) return module.menuItemsWorker(parameters).catch(errorHandler).then(function (response) {\n                    // console.debug('menuItemClick (ItemsWorker)', response);\n                    setProgress('menuItem', false);\n                    hideLoadingIndicator();\n                    hideItemLoadIndicator(itemId, 'menu-item');\n                    return response.menuItems ? renderMenuItems(moduleId, itemId, response.menuItems) : true;\n                });\n            }\n        }\n    }\n}\n\nfunction showItemLoadIndicator(id, attribute) {\n    if (!pms.appearance) pms.appearance = {};\n    if (!pms.appearance.loadIndicators) pms.appearance.loadIndicators = {};\n    var item = document.querySelectorAll('[data-' + attribute + '=\"' + id + '\"]');\n    if (!item || item.length === 0) return false;\n    if (pms.appearance.loadIndicators[attribute + '-' + id]) return false; //else console.debug('showItemLoadIndicator', 'indicator for ' + attribute + '-' + id + ' already active', pms.appearance.loadIndicators[attribute + '-' + id], pms.appearance);\n    pms.appearance.loadIndicators[attribute + '-' + id] = 'initShow';\n    item = item[0];\n    var loader = item.querySelector('.loader-spinner-wrapper');\n    if (!loader || loader.length === 0) {\n        item.innerHTML += '<div class=\"loader-spinner-wrapper\">\\n<div class=\"ispinner ispinner--gray ispinner--animating\">\\n  <div class=\"ispinner__blade\"></div>\\n  <div class=\"ispinner__blade\"></div>\\n  <div class=\"ispinner__blade\"></div>\\n  <div class=\"ispinner__blade\"></div>\\n  <div class=\"ispinner__blade\"></div>\\n  <div class=\"ispinner__blade\"></div>\\n  <div class=\"ispinner__blade\"></div>\\n  <div class=\"ispinner__blade\"></div>\\n  <div class=\"ispinner__blade\"></div>\\n  <div class=\"ispinner__blade\"></div>\\n  <div class=\"ispinner__blade\"></div>\\n  <div class=\"ispinner__blade\"></div>\\n</div></div>';\n    }\n    setTimeout(function () {\n        item.classList.toggle('loader-spinner-active', true);\n        pms.appearance.loadIndicators[attribute + '-' + id] = 'show';\n    }, 100);\n}\n\nfunction hideItemLoadIndicator(id, attribute, recursion) {\n    if (pms.appearance.loadIndicators[attribute + '-' + id] && pms.appearance.loadIndicators[attribute + '-' + id] === 'initShow') {\n        if (!recursion) setTimeout(function () {\n            hideItemLoadIndicator(id, attribute, true);\n        }, 100);\n        return false;\n    }\n    pms.appearance.loadIndicators[attribute + '-' + id] = 'initHide';\n    var item = document.querySelector('[data-' + attribute + '=\"' + id + '\"]');\n    if (!item || item.length === 0) {\n        pms.appearance.loadIndicators[attribute + '-' + id] = false;\n        delete pms.appearance.loadIndicators[attribute + '-' + id];\n        return false;\n    }\n    item.classList.toggle('loader-spinner-active', false);\n    setTimeout(function () {\n        var item = document.querySelector('[data-' + attribute + '=\"' + id + '\"]');\n        if (!item || item.length === 0) {\n            pms.appearance.loadIndicators[attribute + '-' + id] = false;\n            delete pms.appearance.loadIndicators[attribute + '-' + id];\n            return false;\n        }\n        var loader = item.querySelector('.loader-spinner-wrapper');\n        if (loader && loader.length > 0) {\n            loader[0].parentNode.removeChild(loader[0]);\n        }\n        pms.appearance.loadIndicators[attribute + '-' + id] = false;\n        delete pms.appearance.loadIndicators[attribute + '-' + id];\n    }, 500);\n}\n\nfunction showLoadingIndicator() {\n    var result = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : true;\n\n    document.body.style.cursor = 'progress';\n    return result;\n}\n\nfunction hideLoadingIndicator() {\n    var result = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : true;\n\n    document.body.style.cursor = 'default';\n    return result;\n}\n\nfunction leavePage() {\n    return new Promise(function (resolve, reject) {\n        if (!pms.onLeavePage) pms.onLeavePage = [];\n        for (var i in pms.onLeavePage) {\n            if (typeof pms.onLeavePage[i] === \"function\") try {\n                pms.onLeavePage[i]();\n            } catch (e) {\n                console.error(e);\n            }\n        }pms.onLeavePage = [];\n        resolve(true);\n    });\n}\n\nfunction selectHost(id) {\n    return render(template.wrapper)\n    // .then(prepareWrapper)\n    .then(function () {\n        return loadHost(id);\n    }).then(renderHostsSelectMenu).then(hideLoadingIndicator);\n}\n\nfunction isProgress(id) {\n    return pms.progressState[id];\n}\n\nfunction setProgress(id) {\n    var state = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : true;\n\n    pms.progressState[id] = state;\n    if (!state) delete pms.progressState[id];\n    return true;\n}\n\nfunction renderMenuItems(moduleId, menuId, items) {\n    var container = document.querySelectorAll('[data-menu-item-container=\"' + menuId + '\"]');\n    if (!container || container.length === 0) return false;\n    var menuSource = '';\n    for (var i in items) {\n        var item = items[i];\n        var title = item.menu_item_title ? item.menu_item_title : item.title ? item.title : item.id;\n        var description = item.description ? '<p>' + item.description + '</p>' : '';\n        var parameters = item.parameters ? item.parameters : {};\n        if (!item['type']) item['type'] = 'item';\n        parameters['id'] = item.id;\n        menuSource += '<li data-menu-item=\"' + item.id + '\" onclick=\\'menuItemClick(\"' + moduleId + '\",\"' + item.id + '\",' + JSON.stringify(parameters) + ',\"' + item.type + '\")\\'><a href=\"javascript:void(0);\"><span>' + title + '</span>' + description + '</a>' + '</li><ul data-menu-item-container=\"' + item.id + '\"></ul>';\n    }\n    if (container[0]) container[0].innerHTML = menuSource;\n    return true;\n}\n\nfunction getHostUrl(excludePath, hostId) {\n    if (!hostId) hostId = pms.selectedHost.id;\n    var hostData = pms.hostsData[hostId];\n    return (hostData.https ? 'https://' : 'http://') + hostData.domain + (!excludePath && hostData.path ? hostData.path + '/' : '');\n}\n\nfunction loadNotifications(result) {\n    if (!pms.userData.notifications) pms.userData.notifications = [];\n    io('console/getUserNotifications').then(function (response) {\n        if (!response.status || !response.notifications) return false;\n        pms.notifications = response.notifications;\n        if (!pms.notification) pms.notification = {};\n        for (var i in pms.notifications) {\n            if (pms.notifications[i].id) pms.notification[pms.notifications[i].id] = pms.notifications[i];\n        }return true;\n    }).then(renderNotifications);\n    return result;\n}\n\nfunction renderNotifications() {\n    if (!pms.workspace.notificationsWrapper) return false;\n    if (!pms.notifications || pms.notifications.length === 0) return true;\n    var notificationsSource = '';\n    for (var i in pms.notifications) {\n        var notification = pms.notifications[i];\n        if (!notification.id) continue;\n        notificationsSource += '<div class=\"notification background-blur\" data-notification=\"' + notification.id + '\"><div class=\"notification-data\"><div class=\"notification-header\"><div class=\"notification-header-side\">';\n        if (notification.icon) notificationsSource += '<figure style=\"background-image: url(' + notification.icon + ')\"></figure>';\n        if (notification.title) notificationsSource += '<span>' + notification.title + '</span>';\n        notificationsSource += '</div>';\n        if (notification.time) notificationsSource += '<div class=\"notification-header-side\"><span>' + notification.time + '</span></div>';\n        notificationsSource += '</div>';\n        if (notification.body) notificationsSource += '<div class=\"notification-body\">' + notification.body + '</div>';\n        notificationsSource += '</div><div class=\"notification-control\">';\n        if (notification.actions) {\n            for (var _i in notification.actions) {\n                var action = notification.actions[_i];\n                notificationsSource += '<button class=\"notification-control-item\" data-notification-action=\"' + notification.id + '_' + action.id + '\" onclick=\"notifyAction(\\'' + notification.id + '\\',\\'' + action.id + '\\');\">' + action.title + '</button>';\n            }\n        } else notificationsSource += '<button class=\"notification-control-item\" data-notification-action=\"' + notification.id + '_close\" onclick=\"notifyAction(\\'' + notification.id + '\\',\\'close\\');\">Закрыть</button>';\n        notificationsSource += '</div></div>';\n    }\n    pms.workspace.notificationsWrapper.innerHTML = notificationsSource;\n    return true;\n}\n\nfunction notifyAction(notificationId, actionId) {\n    if (!notificationId || !pms.notification[notificationId]) return false;\n    if (isProgress('notification_' + notificationId)) return false;\n    setProgress('notification_' + notificationId);\n    var notification = pms.notification[notificationId];\n    if (!actionId || actionId === 'close') {\n        if (notification.local) {\n            setProgress('notification_' + notificationId, false);\n            return removeNotification(notification.id);\n        }\n        showItemLoadIndicator(notificationId + '_' + actionId, 'notification-action');\n        return io('console/closeUserNotification', { 'notification': notificationId }).then(function (response) {\n            // if (!response) return false;\n            hideItemLoadIndicator(notificationId + '_' + actionId, 'notification-action');\n            setProgress('notification_' + notificationId, false);\n            return removeNotification(notification.id);\n        });\n    } else if (notification.actions[actionId]) {\n        // TODO: Notification actions Here\n        return new Promise(function (resolve, reject) {\n            var action = notification.actions[actionId];\n            resolve(function () {\n                showItemLoadIndicator(notificationId + '_' + actionId, 'notification-action');\n                if (action.method) return action.method(action.parameters ? action.parameters : false);\n                return true;\n            }().then(function (result) {\n                if (!result) return result;\n                return action.closeAfter ? result : io('console/closeUserNotification', { 'notification': notificationId }).then(function (response) {\n                    // hideItemLoadIndicator(notificationId + '_' + actionId, 'notification-action');\n                    // setProgress('notification_' + notificationId, false);\n                    return removeNotification(notification.id).then(function () {\n                        return result;\n                    });\n                });\n            }).then(function () {\n                hideItemLoadIndicator(notificationId + '_' + actionId, 'notification-action');\n                setProgress('notification_' + notificationId, false);\n            }));\n        });\n    } else {\n        setProgress('notification_' + notificationId, false);\n        return false;\n    }\n}\n\nfunction removeNotification(notificationId) {\n    if (!notificationId) return false;\n    var notifications = document.querySelectorAll('[data-notification=\"' + notificationId + '\"]');\n    if (notifications && notifications.length > 0) /*for (let i in notifications) if (notifications[i]) notifications[i].parentNode.removeChild(notifications[i]);*/notifications[0].parentNode.removeChild(notifications[0]);\n    if (pms.notification[notificationId]) {\n        pms.notification[notificationId] = false;\n        delete pms.notification[notificationId];\n    }\n    for (var i in pms.notifications) {\n        if (parseInt(pms.notifications[i].id) === parseInt(notificationId)) {\n            pms.notifications.splice(i, 1);\n            break;\n        }\n    }return true;\n}\n\nfunction createNotification(title, body, icon, id, actions) {\n    /*actions = [\n        {\n            id: 'report',\n            title: 'Отчет',\n            method: reportPluginError,\n            parameters: {message: 'Error message', plugin: 12, time: new Date().getTime()}\n        }\n    ];*/\n    id = id ? pms.notification[id] ? new Date().getTime() : id : new Date().getTime();\n    var data = {\n        id: id,\n        title: title ? title : false,\n        body: body ? body : false,\n        icon: icon ? icon : false,\n        actions: actions ? actions : false,\n        // time: 'Сейчас',\n        local: true\n    };\n    pms.notification[id] = data;\n    return showNotification(data);\n}\n\nfunction showNotification(data) {\n    if (!pms.workspace.notificationsWrapper || !data) return false;\n    var notificationSource = '';\n    var notification = data;\n    if (!notification.id) return false;\n    notificationSource += '<div class=\"notification background-blur\" data-notification=\"' + notification.id + '\"><div class=\"notification-data\"><div class=\"notification-header\"><div class=\"notification-header-side\">';\n    if (notification.icon) notificationSource += '<figure style=\"background-image: url(' + notification.icon + ')\"></figure>';\n    if (notification.title) notificationSource += '<span>' + notification.title + '</span>';\n    notificationSource += '</div>';\n    if (notification.time) notificationSource += '<div class=\"notification-header-side\"><span>' + notification.time + '</span></div>';\n    notificationSource += '</div>';\n    if (notification.body) notificationSource += '<div class=\"notification-body\">' + notification.body + '</div>';\n    notificationSource += '</div><div class=\"notification-control\">';\n    if (notification.actions) {\n        for (var i in notification.actions) {\n            var action = notification.actions[i];\n            notificationSource += '<button class=\"notification-control-item\" data-notification-action=\"' + notification.id + '_' + i + '\" onclick=\"notifyAction(\\'' + notification.id + '\\',\\'' + i + '\\');\">' + action.title + '</button>';\n        }\n    } else notificationSource += '<button class=\"notification-control-item\" data-notification-action=\"' + notification.id + '_close\" onclick=\"notifyAction(\\'' + notification.id + '\\',\\'close\\');\">Закрыть</button>';\n    notificationSource += '</div></div>';\n    pms.workspace.notificationsWrapper.innerHTML += notificationSource;\n    return true;\n}\n\nfunction toggleMobileMenu(state) {\n    if (typeof state === \"boolean\") document.body.classList.toggle('mobile-menu-show', state);else document.body.classList.toggle('mobile-menu-show');\n}\n\nfunction errorHandler(error, message, title, icon) {\n    console.error(message, error);\n    var actions = {\n        close: {\n            id: 'close',\n            title: 'Закрыть'\n        },\n        report: {\n            id: 'report',\n            title: 'Отчет',\n            method: errorReport,\n            parameters: error,\n            closeAfter: true\n        }\n    };\n    createNotification(title ? title : 'Произошла ошибка!', message ? message : error.message, icon ? icon : pms.config.icon, false, actions);\n    return true;\n}\n\nfunction errorReport(error) {\n    error = {\n        message: error.message,\n        stack: error.stack,\n        hostId: pms.selectedHost.id\n    };\n    return io('console/errorHandler', error).then(function (response) {\n        return response.status;\n    });\n}\n\nfunction initPromise(result) {\n    return new Promise(function (resolve, reject) {\n        return resolve(result);\n    });\n}\n\nfunction importModule(moduleId) {\n    return initPromise(moduleId).then(function (moduleId) {\n        var module = pms.module[moduleId];\n        if (!module || !module.loaded) return getModuleData(moduleId).then(loadModule).catch(function (error) {\n            return false;\n        }).then(function (response) {\n            return true;\n        });\n        return true;\n    });\n}\n\n/***/ }),\n/* 1 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nvar _typeof = typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; };\n\nvar _workspace = __webpack_require__(0);\n\nvar workspace = _interopRequireWildcard(_workspace);\n\nvar _auth = __webpack_require__(2);\n\nvar auth = _interopRequireWildcard(_auth);\n\nfunction _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) newObj[key] = obj[key]; } } newObj.default = obj; return newObj; } }\n\nwindow.pms = {\n    config: {\n        apiUrl: 'https://cms.prakula.ru/api/v1/',\n        name: 'PRakula CMS',\n        icon: '/pms-console/assets/images/logo.small.png'\n    }\n};\nwindow.io = io;\nwindow.oldIo = oldIo;\nwindow.initApp = initApp;\n// require('../css/style.css');\n\nwindow.addEventListener('load', function () {\n    pms.config.isFramed = false;\n    try {\n        pms.config.isFramed = window != window.top || document != top.document || self.location != top.location;\n    } catch (e) {\n        pms.config.isFramed = true;\n    }\n    if (pms.config.isFramed) {\n        window.addEventListener('message', function (event) {\n            if (window.initTimeout) clearTimeout(window.initTimeout);\n            delete window.initTimeout;\n            if (_typeof(event.data) === 'object') window.pmsHostData = event.data;\n            initApp();\n        });\n        window.initTimeout = setTimeout(function () {\n            initApp();\n        }, 1000);\n        window.parent.postMessage({ status: true, get: 'pmsHostData' }, '*');\n    } else initApp();\n});\n\nfunction initApp() {\n    if (window.pmsHostData) pms.currentHost = window.pmsHostData;\n    // console.debug(pms);\n    return auth.check().then(function (response) {\n        if (response) {\n            return workspace.prepare();\n        } else {\n            return auth.showLogin();\n        }\n    });\n}\n\nfunction oldIo(method, data, post, url, plainData) {\n    url = url ? url : (pms.config.apiUrl ? pms.config.apiUrl : '/api/') + method;\n    if (!post) {\n        data = data ? data : '';\n        if ((typeof data === 'undefined' ? 'undefined' : _typeof(data)) === 'object') data = Object.keys(data).map(function (k) {\n            return encodeURIComponent(k) + '=' + encodeURIComponent(data[k]);\n        }).join('&');\n    }\n    if (method) {\n        var token = localStorage.getItem('token') ? localStorage.getItem('token') : false;\n        /*(pms.currentHost ?\n            (pms.currentHost.token ? pms.currentHost.token : false) :\n            false);*/\n        if (token) {\n            if (post) data['_token'] = token;else data += (data !== '' ? '&' : '') + '_token=' + token;\n        }\n    }\n    if (data !== '' && !post) url += '?' + data;\n    var parameters = {\n        method: post ? 'POST' : 'GET',\n        mode: 'cors',\n        credentials: 'include'\n    };\n    if (post) parameters.body = JSON.stringify(data);\n    return fetch(url, parameters).then(function (response) {\n        if (response.status >= 200 && response.status < 300) {\n            return response;\n        } else {\n            return plainData ? false : { 'status': false, 'error': response.statusText };\n        }\n    }).then(function (response) {\n        if (!response) return response;\n        if (plainData) return response.text();else return response.json();\n    }).catch(function (response) {\n        var debugData = ['Response parse error'];\n        if (response.message) debugData.push(response.message);\n        if (method) debugData.push(method);\n        if (data !== '') debugData.push(method ? decodeURIComponent(data) : decodeURIComponent(url));\n        console.debug.apply(this, debugData);\n        return { 'status': false, 'error': 'Response parse error' };\n    }).then(function (response) {\n        if (!response || response.error) return response;\n        var debugData = [response.offline ? 'Offline mode' : 'Request successful'];\n        if (method) debugData.push(method);\n        if (data !== '') debugData.push(method ? decodeURIComponent(data) : decodeURIComponent(url));\n        debugData.push(response);\n        console.debug.apply(this, debugData);\n        if (response.offline) initOfflineMode();else pms.offline = false;\n        return response;\n    }).catch(function (error) {\n        console.error(error);\n        return { 'status': false };\n    });\n}\n\nfunction io(method, getData, postData, url, plainData) {\n    url = url ? url : (pms.config.apiUrl ? pms.config.apiUrl : '/api/') + method;\n    getData = getData ? getData : '';\n    if ((typeof getData === 'undefined' ? 'undefined' : _typeof(getData)) === 'object') getData = serialize(getData);\n    postData = postData ? postData : false;\n    if ((typeof postData === 'undefined' ? 'undefined' : _typeof(postData)) === 'object') postData = serialize(postData);\n    if (method && !getCookie('token')) {\n        var token = localStorage.getItem('token');\n        if (token) {\n            getData += (getData !== '' ? '&' : '') + '_token=' + token;\n        }\n    }\n    if (getData !== '') url += '?' + getData;\n    var parameters = {\n        method: postData ? 'POST' : 'GET',\n        mode: 'cors',\n        credentials: 'include'\n    };\n    if (postData) parameters.body = postData;\n    return fetch(url, parameters).then(function (response) {\n        if (response.status >= 200 && response.status < 300) {\n            return response;\n        } else {\n            return plainData ? false : { 'status': false, 'error': response.statusText };\n        }\n    }).then(function (response) {\n        if (!response) return response;\n        if (plainData) return response.text();else return response.json();\n    }).catch(function (response) {\n        var debugData = ['Response parse error'];\n        if (response.message) debugData.push(response.message);\n        if (method) debugData.push(method);\n        if (getData !== '') debugData.push(method ? decodeURIComponent(getData) : decodeURIComponent(url));\n        if (postData && method) debugData.push(decodeURIComponent(postData));\n        console.debug.apply(this, debugData);\n        return { 'status': false, 'error': 'Response parse error' };\n    }).then(function (response) {\n        if (!response || response.error) return response;\n        var debugData = [response.offline ? 'Offline mode' : 'Request successful'];\n        if (method) debugData.push(method);\n        if (getData !== '') debugData.push(method ? decodeURIComponent(getData) : decodeURIComponent(url));\n        if (postData && method) debugData.push(decodeURIComponent(postData));\n        debugData.push(response);\n        console.debug.apply(this, debugData);\n        if (response.offline) initOfflineMode();else pms.offline = false;\n        return response;\n    }).catch(function (error) {\n        console.error(error);\n        return { 'status': false };\n    });\n}\n\nfunction serialize(obj, prefix) {\n    var str = [],\n        p;\n    for (p in obj) {\n        if (obj.hasOwnProperty(p)) {\n            var k = prefix ? prefix + \"[\" + p + \"]\" : p,\n                v = obj[p];\n            str.push(v !== null && (typeof v === 'undefined' ? 'undefined' : _typeof(v)) === \"object\" ? serialize(v, k) : encodeURIComponent(k) + \"=\" + encodeURIComponent(v));\n        }\n    }\n    return str.join(\"&\");\n}\n\nfunction getCookie(name) {\n    var matches = document.cookie.match(new RegExp(\"(?:^|; )\" + name.replace(/([\\.$?*|{}\\(\\)\\[\\]\\\\\\/\\+^])/g, '\\\\$1') + \"=([^;]*)\"));\n    return matches ? decodeURIComponent(matches[1]) : undefined;\n}\n\nfunction initOfflineMode() {\n    if (pms.offline === true) return true;\n    pms.offline = true;\n    alert('Мы потеряли соединение с сервером, проверьте подключение и повторите');\n    return true;\n}\n\n/***/ }),\n/* 2 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\nexports.check = check;\nexports.send = send;\nexports.showLogin = showLogin;\n\nvar _workspace = __webpack_require__(0);\n\nvar workspace = _interopRequireWildcard(_workspace);\n\nfunction _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) newObj[key] = obj[key]; } } newObj.default = obj; return newObj; } }\n\nvar template = {};\n\nwindow.auth = { logout: logout };\n\nfunction check() {\n    return io('console/getUserData').then(function (response) {\n        if (response.status) saveUserData(response);\n        return response.status;\n    });\n}\n\nfunction send(login, password) {\n    // auth.loginSection.classList.toggle('incorrect-data', false);\n    return new Promise(function (resolve, reject) {\n        if (!login || login === '') return resolve(loginError('empty_login', 'login'));\n        if (!login || password === '') return resolve(loginError('empty_password', 'password'));\n        showItemLoadIndicator('auth', 'login-button');\n        var data = { login: login, password: password };\n        return resolve(io('console/auth', data));\n    });\n}\n\nfunction loginError(message, type) {\n    // return new Promise(function (resolve, reject) {\n    var authLogin = document.getElementById('auth-login');\n    var loginMessage = document.getElementById('auth-login-message');\n    var authPassword = document.getElementById('auth-password');\n    var passwordMessage = document.getElementById('auth-password-message');\n    if (type) switch (type) {\n        case 'login':\n            switch (message) {\n                case 'empty_login':\n                    loginMessage.innerText = 'Необходимо ввести ваш логин';\n                    break;\n            }\n            authLogin.classList.toggle('highlight', true);\n            break;\n        case 'password':\n            switch (message) {\n                case 'empty_password':\n                    passwordMessage.innerText = 'Необходимо ввести ваш пароль';\n                    break;\n                case 'incorrect_data':\n                    passwordMessage.innerText = 'Указан неверный пароль';\n                    break;\n            }\n            authPassword.classList.toggle('highlight', true);\n            break;\n        case 'all':\n            switch (message) {\n                case 'bad_parameters':\n                    loginMessage.innerText = 'Необходимо ввести ваш логин';\n                    passwordMessage.innerText = 'Необходимо ввести ваш пароль';\n                    break;\n            }\n            authLogin.classList.toggle('highlight', true);\n            authPassword.classList.toggle('highlight', true);\n\n    }\n    hideItemLoadIndicator('auth', 'login-button');\n    setProgress('auth-button', false);\n    auth.loginSection.classList.toggle('incorrect-data', true);\n    setTimeout(function () {\n        auth.loginSection.classList.toggle('incorrect-data', false);\n    }, 500);\n    console.log(message ? message : type);\n    return false; // resolve(false);\n    // });\n}\n\nfunction showLogin() {\n    if (!template.login) return workspace.loadTemplate('login').then(function (response) {\n        if (!response) return 'Не удалось загрузить страницу';\n        return template.login = response;\n    }).then(workspace.render).then(prepareLogin);else return workspace.render(template.login).then(prepareLogin);\n}\n\nfunction prepareLogin() {\n    if (pms.currentHost) {\n        if (pms.currentHost.title && document.getElementById('host-name')) document.getElementById('host-name').innerText = pms.currentHost.title;\n        if (pms.currentHost.logo && document.getElementById('host-logo')) document.getElementById('host-logo').src = pms.currentHost.logo;\n        if (pms.currentHost.homePage && document.getElementById('home-page')) document.getElementById('home-page').href = pms.currentHost.homePage;\n    }\n    if (document.getElementById('login-section')) auth.loginSection = document.getElementById('login-section');\n    if (document.getElementById('auth-button')) document.getElementById('auth-button').addEventListener('click', function () {\n        if (isProgress('auth-button')) return false;\n        if (!document.getElementById('auth-login') || !document.getElementById('auth-password')) return false;\n        document.getElementById('auth-login').classList.toggle('highlight', false);\n        document.getElementById('auth-login-message').innerText = '';\n        document.getElementById('auth-password').classList.toggle('highlight', false);\n        document.getElementById('auth-password-message').innerText = '';\n        setProgress('auth-button');\n        showLoadingIndicator();\n        return send(document.getElementById('auth-login').value, document.getElementById('auth-password').value).then(function (response) {\n            if (!response) return false;\n            if (!response.status) return loginError('incorrect_data', 'password');\n            if (response.token) {\n                localStorage.setItem('token', response.token);\n                /*if (pms.config.isFramed) window.parent.postMessage({\n                    status: true,\n                    set: 'token',\n                    data: response.token\n                }, '*');*/\n            }\n            pms.onLeavePage.push(function () {\n                hideItemLoadIndicator('auth', 'login-button');\n            });\n            saveUserData(response);\n            return workspace.prepare();\n        }).then(hideLoadingIndicator).then(function () {\n            return setProgress('auth-button', false);\n        });\n    });\n    return true;\n}\n\nfunction saveUserData(response) {\n    if (!response || !response.status) return false;\n    pms.userData = {};\n    if (response.userId) pms.userData.id = response.userId;\n    if (response.login) pms.userData.login = response.login;\n    if (response.email) pms.userData.email = response.email;\n    if (response.firstname) pms.userData.firstname = response.firstname;\n    if (response.lastname) pms.userData.lastname = response.lastname;\n    if (response.avamoji) pms.userData.avamoji = response.avamoji;\n\n    var OneSignal = window.OneSignal || [];\n    OneSignal.push([\"init\", {\n        appId: \"d6d3da7e-593f-4b75-a598-a5d4b27e31e6\",\n        autoRegister: true,\n        notifyButton: {\n            enable: false\n        },\n        promptOptions: {\n            actionMessage: \"Уведомим о важных событиях связанных с сайтом, продвижением страниц и других изменениях\",\n            acceptButtonText: \"Получать\",\n            cancelButtonText: \"Отказаться\"\n        }\n    }]);\n    return true;\n}\n\nfunction logout() {\n    return io('console/logout').then(function (response) {\n        if (response && response.status) {\n            window.pms = {\n                config: pms.config\n            };\n            localStorage.clear();\n            return showLogin();\n        } else alert('Произошла ошибка');\n    });\n}\n\n/***/ })\n/******/ ]);\n\n\n// WEBPACK FOOTER //\n// init.js"," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"/pms-console/\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 1);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap 962b6b41123f3c54641c","let template = {};\n\nwindow.menuItemClick = menuItemClick;\nwindow.workspace = {render: render, loadTemplate: loadTemplate, require: require, leavePage: leavePage, init: init};\nwindow.showLoadingIndicator = showLoadingIndicator;\nwindow.hideLoadingIndicator = hideLoadingIndicator;\nwindow.showItemLoadIndicator = showItemLoadIndicator;\nwindow.hideItemLoadIndicator = hideItemLoadIndicator;\nwindow.selectHost = selectHost;\nwindow.isProgress = isProgress;\nwindow.setProgress = setProgress;\nwindow.getHostUrl = getHostUrl;\nwindow.notifyAction = notifyAction;\nwindow.createNotification = createNotification;\nwindow.showNotification = showNotification;\nwindow.errorHandler = errorHandler;\nwindow.initPromise = initPromise;\nwindow.importModule = importModule;\n\nwindow.onerror = function (message, url, lineNumber) {\n    return errorHandler(arguments, message);\n    /*alert(\"Поймана ошибка, выпавшая в глобальную область!\\n\" +\n        \"Сообщение: \" + message + \"\\n(\" + url + \":\" + lineNumber + \")\");*/\n};\n\nexport function init() {\n    if (!pms.workspace) pms.workspace = {};\n    if (!pms.onLeavePage) pms.onLeavePage = [];\n    if (!pms.appearance) pms.appearance = {};\n    if (!pms.appearance.loadIndicators) pms.appearance.loadIndicators = {};\n    if (!pms.progressState) pms.progressState = {};\n\n    window.addEventListener('touchstart', function onFirstTouch() {\n        document.body.classList.toggle('touchscreen', true);\n        window.removeEventListener('touchstart', onFirstTouch, false);\n    }, false);\n\n    if (/iPad|iPhone|iPod/.test(navigator.userAgent) && !window.MSStream) {\n        pms.workspace.iOS = true;\n        if ((\"standalone\" in window.navigator) && window.navigator.standalone) document.body.classList.toggle('ios-standalone', true);\n    } else if (navigator.userAgent.toLowerCase().indexOf('safari') !== -1 && navigator.userAgent.toLowerCase().indexOf('chrome') < 0) {\n        pms.workspace.macOs = true;\n    } else {\n        document.body.classList.toggle('material', true);\n    }\n}\n\nexport function require(script) {\n    return io(false, false, false, './assets/js/' + script + '.js', true)\n        .then(function (response) {\n            if (!response) return false;\n            try {\n                eval.apply(window, [response]);\n            } catch (e) {\n                console.error(e);\n                return false;\n            }\n            return true;\n        })\n}\n\nexport function prepare() {\n    init();\n    initHistoryHandler.bind(this)();\n    showLoadingIndicator();\n    if (!template.wrapper) return loadTemplate('wrapper')\n        .then(function (response) {\n            if (!response) {\n                alert('Не удалось загрузить страницу');\n                return false;\n            }\n            return template.wrapper = response;\n        })\n        // .then(prepareWrapper)\n        .then(updateHostsData).then(function () {\n            return render(template.wrapper);\n        })\n        .then(loadHost)\n        .then(renderHostsSelectMenu).then(loadNotifications)\n        .then(hideLoadingIndicator);\n    else\n        return updateHostsData().then(function () {\n            return render(template.wrapper);\n        })\n            .then(loadHost)\n            .then(renderHostsSelectMenu).then(loadNotifications)\n            .then(hideLoadingIndicator);\n}\n\nfunction initHistoryHandler() {\n    window.addEventListener('popstate', function (event) {\n        if (event.state && event.state.type && event.state.type === 'workspace') {\n            leavePage();\n            document.querySelector('#workspace-wrapper').innerHTML = `<div class=\"flex-center center-text\">\n            <div><h3 class=\"slim-title\">Добро пожаловать!</h3><br>\n                <h3 class=\"slim-subtitle\">Для начала, выберите необходимый раздел в <span\n                        class=\"hide-on-mobile\">боковом</span><span class=\"hide-on-desktop\">верхнем</span> Меню</h3>\n            </div>\n        </div>`;\n        }\n    }.bind(this));\n    history.pushState({type: 'workspace'}, \"Панель управления Cotton Baby\");\n}\n\nfunction prepareWrapper() {\n    if (pms.selectedHost) {\n        if (pms.selectedHost.title && document.getElementById('host-name'))\n            document.getElementById('host-name').innerText = pms.selectedHost.title;\n        if (pms.selectedHost.logo && document.getElementById('host-logo'))\n            document.getElementById('host-logo').src = pms.selectedHost.logo;\n        if (pms.selectedHost.homePage && document.getElementById('home-page'))\n            document.getElementById('home-page').href = pms.selectedHost.homePage;\n    } else if (pms.currentHost) {\n        if (pms.currentHost.title && document.getElementById('host-name'))\n            document.getElementById('host-name').innerText = pms.currentHost.title;\n        if (pms.currentHost.logo && document.getElementById('host-logo'))\n            document.getElementById('host-logo').src = pms.currentHost.logo;\n        if (pms.currentHost.homePage && document.getElementById('home-page'))\n            document.getElementById('home-page').href = pms.currentHost.homePage;\n    }\n    if (document.getElementById('select-hosts-menu')) document.getElementById('select-hosts-menu').addEventListener('change', function () {\n        selectHost(this.value);\n    });\n    if (document.getElementById('header-menu-button')) document.getElementById('header-menu-button').addEventListener('click', toggleMobileMenu);\n    let userName = pms.userData.firstname ? pms.userData.firstname + (pms.userData.lastname ? ' ' + pms.userData.lastname : '') : (pms.userData.login ? pms.userData.login : 'Любимый пользователь');\n    if (document.getElementById('user-name')) document.getElementById('user-name').innerText = userName;\n    if (pms.userData.avamoji && document.getElementById('user-avamoji')) document.getElementById('user-avamoji').innerText = pms.userData.avamoji;\n    if (document.getElementById('workspace-menu'))\n        pms.workspace.menu = document.getElementById('workspace-menu');\n    if (document.getElementById('workspace-wrapper'))\n        pms.workspace.wrapper = document.getElementById('workspace-wrapper');\n    if (document.getElementById('notificationsWrapper')) {\n        pms.workspace.notificationsWrapper = document.getElementById('notificationsWrapper');\n    }\n    return true;\n}\n\nexport function loadTemplate(id) {\n    return io(false, false, false, './' + id + '.html', true)\n        .then(function (response) {\n            if (typeof response !== 'string') return false;\n            else return response;\n        });\n}\n\nexport function render(html, node = document.body) {\n    init();\n    leavePage(); /// FUUUCK!!!!\n    return new Promise(function (resolve, reject) {\n        if (!html) return false;\n        node.innerHTML = html;\n        return resolve(node);\n    });\n}\n\nexport function updateHostsData() {\n    return io('console/getHosts').then(function (response) {\n        if (!response.status) return false;\n        if (response.hostsData) {\n            if (!pms.hostsData) pms.hostsData = {};\n            if (!pms.domainsHost) pms.domainsHost = {};\n            for (let i in response.hostsData) {\n                pms.hostsData[response.hostsData[i].id] = response.hostsData[i];\n                pms.domainsHost[response.hostsData[i].domain] = response.hostsData[i];\n            }\n        }\n        return true;\n    })\n}\n\nexport function renderHostsSelectMenu() {\n    let outputSource = '<option selected disabled>🌐 Выбрать Сайт</option>';\n    let hostsDataKeys = Object.keys(pms.hostsData);\n    for (let i in hostsDataKeys) {\n        let host = pms.hostsData[hostsDataKeys[i]];\n        let title = host.title ? host.title : host.domain;\n        //let active = pms.selectedHost ? (pms.selectedHost.id === host.id ? 'selected' : '') : '';\n        outputSource += '<option value=\"' + host.id + '\" ' + '>' + title + '</option>';\n    }\n    let menuNode = document.getElementById('select-hosts-menu');\n    menuNode.innerHTML = outputSource;\n    if (hostsDataKeys.length > 1) menuNode.parentNode.style.display = 'initial';\n    else menuNode.parentNode.style.display = 'none';\n    return true;\n}\n\nexport function loadHost(id) {\n    leavePage();\n    return new Promise(function (resolve, reject) {\n        if (!pms.hostsData) return resolve(false);\n        if (!id || !(typeof id === \"string\" || typeof id === \"number\")) {\n            id = false;\n            if (pms.currentHost && pms.currentHost.domain)\n                if (pms.domainsHost[pms.currentHost.domain]) id = pms.domainsHost[pms.currentHost.domain].id;\n            id = id ? id : Object.keys(pms.hostsData)[0];\n        }\n        let host = pms.selectedHost = pms.hostsData[id];\n        if (!host.modules) return resolve(getHostModules(host.id).then(function (response) {\n            if (!response) return response;\n            return host;\n        }).then(prepareWrapper).then(loadMenu));\n        return resolve(new Promise(function (resolve, reject) {\n            return resolve(prepareWrapper());\n        }).then(loadMenu));\n    });\n}\n\nexport function getHostModules(hostId) {\n    return io('console/getModules', {hostId: hostId}).then(function (response) {\n        if (!response.status) return false;\n        let host = pms.hostsData[hostId];\n        host.menuStructure = [];\n        if (!host.modules) host.modules = {};\n        for (let i in response.modulesData) {\n            let moduleData = response.modulesData[i];\n            if (!pms.module) pms.module = {};\n            if (!pms.module[moduleData.id]) pms.module[moduleData.id] = moduleData;\n            host.modules[moduleData.id] = pms.module[moduleData.id];\n            host.menuStructure.push(host.modules[moduleData.id]);\n        }\n        return true;\n    })\n}\n\nexport function getModuleData(moduleId, hostId = false) {\n    hostId = hostId ? hostId : pms.selectedHost.id;\n    // console.debug('getModuleData', moduleId, hostId);\n    return new Promise(function (resolve, reject) {\n        if (pms.hostsData[hostId].modules[moduleId].init) return resolve(moduleId);\n        else return resolve(io('console/getModuleData', {\n            moduleId: moduleId,\n            hostId: hostId\n        }).then(function (response) {\n            if (!response.status || !response.init) return false;\n            let host = pms.hostsData[hostId];\n            host.modules[moduleId].init = response.init;\n            return moduleId;\n        }));\n    });\n}\n\nexport function loadModule(moduleId) {\n    return new Promise(function (resolve, reject) {\n        if (!pms.module[moduleId] || !pms.module[moduleId].init) return resolve(false);\n        if (pms.module[moduleId].loaded) return resolve(true);\n        try {\n            eval(pms.module[moduleId].init);\n        } catch (e) {\n            reject(e);\n        }\n        pms.module[moduleId].loaded = true;\n        return resolve(true);\n    });\n}\n\nexport function loadMenu() {\n    if (!pms.selectedHost || !pms.selectedHost.modules) return false;\n    let modules = pms.selectedHost.menuStructure ? pms.selectedHost.menuStructure : pms.selectedHost.modules;\n    let menuSource = '<h2>Меню:</h2><ul>';\n    for (let i in modules) {\n        let module = pms.module[modules[i].id];\n        let title = module.menu_item_title ? module.menu_item_title : (module.title ? module.title : module.id);\n        let description = module.description ? ('<p>' + module.description + '</p>') : '';\n        menuSource += '<li data-menu-item=\"' + module.id + '\" onclick=\"menuItemClick(\\'' + module.id + '\\')\"><a href=\"javascript:void(0);\"><span>' + title + '</span>' + description + '</a>' + '</li><ul data-menu-item-container=\"' + module.id + '\"></ul>';\n    }\n    menuSource += '</ul>';\n    if (pms.workspace.menu) pms.workspace.menu.innerHTML = menuSource;\n    return true;\n}\n\nexport function menuItemClick(moduleId = false, itemId = false, parameters = false, type = false) {\n    if (isProgress('menuItem')) return false;\n    setProgress('menuItem');\n    let module = pms.module[moduleId];\n    if (!itemId) itemId = moduleId;\n    showItemLoadIndicator(itemId, 'menu-item');\n    showLoadingIndicator();\n    if (!parameters) {\n        if (module.menu_item_type && module.menu_item_type === 'item') {\n            if (!module.loaded) getModuleData(moduleId).then(loadModule).catch(function (error) {\n                return false;\n            }).then(function (response) {\n                if (!response || !module.loaded) alert('Раздел временно недоступен');\n                if (module.workspaceGenerator) return module.workspaceGenerator();\n                return {status: true};\n            }).then(function (response) {\n                if (typeof response !== 'object') return false;\n                if (!response.status) console.debug(moduleId, response.statusText ? response.statusText : response);\n                return true;\n            }).then(function (result) {\n                setProgress('menuItem', false);\n                hideLoadingIndicator();\n                hideItemLoadIndicator(itemId, 'menu-item');\n                toggleMobileMenu(false);\n                return result;\n            });\n            else if (module.workspaceGenerator)\n                return module.workspaceGenerator()\n                    .then(function (result) {\n                        setProgress('menuItem', false);\n                        hideLoadingIndicator();\n                        hideItemLoadIndicator(itemId, 'menu-item');\n                        toggleMobileMenu(false);\n                        return result;\n                    });\n        } else if (module.menu_item_type && module.menu_item_type === 'group') {\n            if (!module.loaded) getModuleData(moduleId).then(loadModule).catch(function (error) {\n                return false;\n            }).then(function (response) {\n                if (!response || !module.loaded) alert('Раздел временно недоступен');\n                if (module.menuItemsWorker) return module.menuItemsWorker();\n                return {status: true};\n            }).then(function (response) {\n                // console.debug(response);\n                if (typeof response !== 'object') return false;\n                if (!response.status) console.debug(moduleId, response.statusText ? response.statusText : response);\n                return response.menuItems ? renderMenuItems(moduleId, itemId, response.menuItems) : true;\n            }).then(function (result) {\n                setProgress('menuItem', false);\n                hideLoadingIndicator();\n                hideItemLoadIndicator(itemId, 'menu-item');\n                return result;\n            });\n            else if (module.menuItemsWorker)\n                return module.menuItemsWorker().then(function (response) {\n                    console.debug(response);\n                    if (typeof response !== 'object') return false;\n                    if (!response.status) console.debug(moduleId, response.statusText ? response.statusText : response);\n                    return response.menuItems ? renderMenuItems(moduleId, itemId, response.menuItems) : true;\n                }).then(function (result) {\n                    setProgress('menuItem', false);\n                    hideLoadingIndicator();\n                    hideItemLoadIndicator(itemId, 'menu-item');\n                    return result;\n                });\n            setProgress('menuItem', false);\n            hideLoadingIndicator();\n            hideItemLoadIndicator(itemId, 'menu-item');\n        }\n    } else {\n        if (!type) {\n\n        } else {\n            // console.debug(moduleId, parameters, type);\n            if (type === 'item') {\n                if (module.workspaceGenerator)\n                    return module.workspaceGenerator(parameters)\n                        .catch(errorHandler)\n                        .then(function (result) {\n                            setProgress('menuItem', false);\n                            hideLoadingIndicator();\n                            hideItemLoadIndicator(itemId, 'menu-item');\n                            toggleMobileMenu(false);\n                            return result;\n                        });\n            } else if (type === 'group') {\n                if (module.menuItemsWorker)\n                    return module.menuItemsWorker(parameters)\n                        .catch(errorHandler)\n                        .then(function (response) {\n                            // console.debug('menuItemClick (ItemsWorker)', response);\n                            setProgress('menuItem', false);\n                            hideLoadingIndicator();\n                            hideItemLoadIndicator(itemId, 'menu-item');\n                            return response.menuItems ? renderMenuItems(moduleId, itemId, response.menuItems) : true;\n                        });\n            }\n        }\n    }\n}\n\nexport function showItemLoadIndicator(id, attribute) {\n    if (!pms.appearance) pms.appearance = {};\n    if (!pms.appearance.loadIndicators) pms.appearance.loadIndicators = {};\n    let item = document.querySelectorAll('[data-' + attribute + '=\"' + id + '\"]');\n    if (!item || item.length === 0) return false;\n    if (pms.appearance.loadIndicators[attribute + '-' + id]) return false; //else console.debug('showItemLoadIndicator', 'indicator for ' + attribute + '-' + id + ' already active', pms.appearance.loadIndicators[attribute + '-' + id], pms.appearance);\n    pms.appearance.loadIndicators[attribute + '-' + id] = 'initShow';\n    item = item[0];\n    let loader = item.querySelector('.loader-spinner-wrapper');\n    if (!loader || loader.length === 0) {\n        item.innerHTML += `<div class=\"loader-spinner-wrapper\">\n<div class=\"ispinner ispinner--gray ispinner--animating\">\n  <div class=\"ispinner__blade\"></div>\n  <div class=\"ispinner__blade\"></div>\n  <div class=\"ispinner__blade\"></div>\n  <div class=\"ispinner__blade\"></div>\n  <div class=\"ispinner__blade\"></div>\n  <div class=\"ispinner__blade\"></div>\n  <div class=\"ispinner__blade\"></div>\n  <div class=\"ispinner__blade\"></div>\n  <div class=\"ispinner__blade\"></div>\n  <div class=\"ispinner__blade\"></div>\n  <div class=\"ispinner__blade\"></div>\n  <div class=\"ispinner__blade\"></div>\n</div></div>`\n    }\n    setTimeout(function () {\n        item.classList.toggle('loader-spinner-active', true);\n        pms.appearance.loadIndicators[attribute + '-' + id] = 'show';\n    }, 100);\n}\n\nexport function hideItemLoadIndicator(id, attribute, recursion) {\n    if (pms.appearance.loadIndicators[attribute + '-' + id] && pms.appearance.loadIndicators[attribute + '-' + id] === 'initShow') {\n        if (!recursion) setTimeout(function () {\n            hideItemLoadIndicator(id, attribute, true)\n        }, 100);\n        return false;\n    }\n    pms.appearance.loadIndicators[attribute + '-' + id] = 'initHide';\n    let item = document.querySelector('[data-' + attribute + '=\"' + id + '\"]');\n    if (!item || item.length === 0) {\n        pms.appearance.loadIndicators[attribute + '-' + id] = false;\n        delete pms.appearance.loadIndicators[attribute + '-' + id];\n        return false;\n    }\n    item.classList.toggle('loader-spinner-active', false);\n    setTimeout(function () {\n        let item = document.querySelector('[data-' + attribute + '=\"' + id + '\"]');\n        if (!item || item.length === 0) {\n            pms.appearance.loadIndicators[attribute + '-' + id] = false;\n            delete pms.appearance.loadIndicators[attribute + '-' + id];\n            return false;\n        }\n        let loader = item.querySelector('.loader-spinner-wrapper');\n        if (loader && loader.length > 0) {\n            loader[0].parentNode.removeChild(loader[0]);\n        }\n        pms.appearance.loadIndicators[attribute + '-' + id] = false;\n        delete pms.appearance.loadIndicators[attribute + '-' + id];\n    }, 500);\n}\n\nexport function showLoadingIndicator(result = true) {\n    document.body.style.cursor = 'progress';\n    return result;\n}\n\nexport function hideLoadingIndicator(result = true) {\n    document.body.style.cursor = 'default';\n    return result;\n}\n\nexport function leavePage() {\n    return new Promise(function (resolve, reject) {\n        if (!pms.onLeavePage) pms.onLeavePage = [];\n        for (let i in pms.onLeavePage) if (typeof pms.onLeavePage[i] === \"function\") try {\n            pms.onLeavePage[i]();\n        } catch (e) {\n            console.error(e);\n        }\n        pms.onLeavePage = [];\n        resolve(true);\n    });\n}\n\nexport function selectHost(id) {\n    return render(template.wrapper)\n    // .then(prepareWrapper)\n        .then(function () {\n            return loadHost(id);\n        }).then(renderHostsSelectMenu)\n        .then(hideLoadingIndicator);\n}\n\nexport function isProgress(id) {\n    return pms.progressState[id];\n}\n\nexport function setProgress(id, state = true) {\n    pms.progressState[id] = state;\n    if (!state) delete pms.progressState[id];\n    return true;\n}\n\nexport function renderMenuItems(moduleId, menuId, items) {\n    let container = document.querySelectorAll('[data-menu-item-container=\"' + menuId + '\"]');\n    if (!container || container.length === 0) return false;\n    let menuSource = '';\n    for (let i in items) {\n        let item = items[i];\n        let title = item.menu_item_title ? item.menu_item_title : (item.title ? item.title : item.id);\n        let description = item.description ? ('<p>' + item.description + '</p>') : '';\n        let parameters = item.parameters ? item.parameters : {};\n        if (!item['type']) item['type'] = 'item';\n        parameters['id'] = item.id;\n        menuSource += '<li data-menu-item=\"' + item.id + '\" onclick=\\'menuItemClick(\"' + moduleId + '\",\"' + item.id + '\",' + JSON.stringify(parameters) + ',\"' + item.type + '\")\\'><a href=\"javascript:void(0);\"><span>' + title + '</span>' + description + '</a>' + '</li><ul data-menu-item-container=\"' + item.id + '\"></ul>';\n    }\n    if (container[0]) container[0].innerHTML = menuSource;\n    return true;\n}\n\nexport function getHostUrl(excludePath, hostId) {\n    if (!hostId) hostId = pms.selectedHost.id;\n    let hostData = pms.hostsData[hostId];\n    return (hostData.https ? 'https://' : 'http://') + hostData.domain + (!excludePath && hostData.path ? hostData.path + '/' : '');\n}\n\nexport function loadNotifications(result) {\n    if (!pms.userData.notifications) pms.userData.notifications = [];\n    io('console/getUserNotifications').then(function (response) {\n        if (!response.status || !response.notifications) return false;\n        pms.notifications = response.notifications;\n        if (!pms.notification) pms.notification = {};\n        for (let i in pms.notifications) if (pms.notifications[i].id) pms.notification[pms.notifications[i].id] = pms.notifications[i];\n        return true;\n    }).then(renderNotifications);\n    return result;\n}\n\nexport function renderNotifications() {\n    if (!pms.workspace.notificationsWrapper) return false;\n    if (!pms.notifications || pms.notifications.length === 0) return true;\n    let notificationsSource = '';\n    for (let i in pms.notifications) {\n        let notification = pms.notifications[i];\n        if (!notification.id) continue;\n        notificationsSource += '<div class=\"notification background-blur\" data-notification=\"' + notification.id + '\"><div class=\"notification-data\"><div class=\"notification-header\"><div class=\"notification-header-side\">';\n        if (notification.icon) notificationsSource += '<figure style=\"background-image: url(' + notification.icon + ')\"></figure>';\n        if (notification.title) notificationsSource += '<span>' + notification.title + '</span>';\n        notificationsSource += '</div>';\n        if (notification.time) notificationsSource += '<div class=\"notification-header-side\"><span>' + notification.time + '</span></div>';\n        notificationsSource += '</div>';\n        if (notification.body) notificationsSource += '<div class=\"notification-body\">' + notification.body + '</div>';\n        notificationsSource += '</div><div class=\"notification-control\">';\n        if (notification.actions) {\n            for (let i in notification.actions) {\n                let action = notification.actions[i];\n                notificationsSource += '<button class=\"notification-control-item\" data-notification-action=\"' + notification.id + '_' + action.id + '\" onclick=\"notifyAction(\\'' + notification.id + '\\',\\'' + action.id + '\\');\">' + action.title + '</button>';\n            }\n        } else notificationsSource += '<button class=\"notification-control-item\" data-notification-action=\"' + notification.id + '_close\" onclick=\"notifyAction(\\'' + notification.id + '\\',\\'close\\');\">Закрыть</button>';\n        notificationsSource += '</div></div>';\n    }\n    pms.workspace.notificationsWrapper.innerHTML = notificationsSource;\n    return true;\n}\n\nexport function notifyAction(notificationId, actionId) {\n    if (!notificationId || !pms.notification[notificationId]) return false;\n    if (isProgress('notification_' + notificationId)) return false;\n    setProgress('notification_' + notificationId);\n    let notification = pms.notification[notificationId];\n    if (!actionId || actionId === 'close') {\n        if (notification.local) {\n            setProgress('notification_' + notificationId, false);\n            return removeNotification(notification.id);\n        }\n        showItemLoadIndicator(notificationId + '_' + actionId, 'notification-action');\n        return io('console/closeUserNotification', {'notification': notificationId}).then(function (response) {\n            // if (!response) return false;\n            hideItemLoadIndicator(notificationId + '_' + actionId, 'notification-action');\n            setProgress('notification_' + notificationId, false);\n            return removeNotification(notification.id);\n        });\n    } else if (notification.actions[actionId]) {\n        // TODO: Notification actions Here\n        return new Promise(function (resolve, reject) {\n            let action = notification.actions[actionId];\n            resolve(function () {\n                showItemLoadIndicator(notificationId + '_' + actionId, 'notification-action');\n                if (action.method) return action.method(action.parameters ? action.parameters : false);\n                return true;\n            }().then(function (result) {\n                if (!result) return result;\n                return action.closeAfter ? result : io('console/closeUserNotification', {'notification': notificationId})\n                    .then(function (response) {\n                        // hideItemLoadIndicator(notificationId + '_' + actionId, 'notification-action');\n                        // setProgress('notification_' + notificationId, false);\n                        return removeNotification(notification.id).then(function () {\n                            return result;\n                        });\n                    });\n            }).then(function () {\n                hideItemLoadIndicator(notificationId + '_' + actionId, 'notification-action');\n                setProgress('notification_' + notificationId, false);\n            }));\n        });\n\n    } else {\n        setProgress('notification_' + notificationId, false);\n        return false;\n    }\n}\n\nexport function removeNotification(notificationId) {\n    if (!notificationId) return false;\n    let notifications = document.querySelectorAll('[data-notification=\"' + notificationId + '\"]');\n    if (notifications && notifications.length > 0) /*for (let i in notifications) if (notifications[i]) notifications[i].parentNode.removeChild(notifications[i]);*/ notifications[0].parentNode.removeChild(notifications[0]);\n    if (pms.notification[notificationId]) {\n        pms.notification[notificationId] = false;\n        delete pms.notification[notificationId];\n    }\n    for (let i in pms.notifications) if (parseInt(pms.notifications[i].id) === parseInt(notificationId)) {\n        pms.notifications.splice(i, 1);\n        break;\n    }\n    return true;\n}\n\nexport function createNotification(title, body, icon, id, actions) {\n    /*actions = [\n        {\n            id: 'report',\n            title: 'Отчет',\n            method: reportPluginError,\n            parameters: {message: 'Error message', plugin: 12, time: new Date().getTime()}\n        }\n    ];*/\n    id = id ? (pms.notification[id] ? new Date().getTime() : id) : new Date().getTime();\n    let data = {\n        id: id,\n        title: title ? title : false,\n        body: body ? body : false,\n        icon: icon ? icon : false,\n        actions: actions ? actions : false,\n        // time: 'Сейчас',\n        local: true\n    };\n    pms.notification[id] = data;\n    return showNotification(data);\n}\n\nexport function showNotification(data) {\n    if (!pms.workspace.notificationsWrapper || !data) return false;\n    let notificationSource = '';\n    let notification = data;\n    if (!notification.id) return false;\n    notificationSource += '<div class=\"notification background-blur\" data-notification=\"' + notification.id + '\"><div class=\"notification-data\"><div class=\"notification-header\"><div class=\"notification-header-side\">';\n    if (notification.icon) notificationSource += '<figure style=\"background-image: url(' + notification.icon + ')\"></figure>';\n    if (notification.title) notificationSource += '<span>' + notification.title + '</span>';\n    notificationSource += '</div>';\n    if (notification.time) notificationSource += '<div class=\"notification-header-side\"><span>' + notification.time + '</span></div>';\n    notificationSource += '</div>';\n    if (notification.body) notificationSource += '<div class=\"notification-body\">' + notification.body + '</div>';\n    notificationSource += '</div><div class=\"notification-control\">';\n    if (notification.actions) {\n        for (let i in notification.actions) {\n            let action = notification.actions[i];\n            notificationSource += '<button class=\"notification-control-item\" data-notification-action=\"' + notification.id + '_' + i + '\" onclick=\"notifyAction(\\'' + notification.id + '\\',\\'' + i + '\\');\">' + action.title + '</button>';\n        }\n    } else notificationSource += '<button class=\"notification-control-item\" data-notification-action=\"' + notification.id + '_close\" onclick=\"notifyAction(\\'' + notification.id + '\\',\\'close\\');\">Закрыть</button>';\n    notificationSource += '</div></div>';\n    pms.workspace.notificationsWrapper.innerHTML += notificationSource;\n    return true;\n}\n\nfunction toggleMobileMenu(state) {\n    if (typeof state === \"boolean\") document.body.classList.toggle('mobile-menu-show', state);\n    else document.body.classList.toggle('mobile-menu-show');\n}\n\nexport function errorHandler(error, message, title, icon) {\n    console.error(message, error);\n    let actions = {\n        close: {\n            id: 'close',\n            title: 'Закрыть'\n        },\n        report: {\n            id: 'report',\n            title: 'Отчет',\n            method: errorReport,\n            parameters: error,\n            closeAfter: true\n        }\n    };\n    createNotification(\n        title ? title : 'Произошла ошибка!',\n        message ? message : error.message,\n        icon ? icon : pms.config.icon,\n        false, actions);\n    return true;\n}\n\nfunction errorReport(error) {\n    error = {\n        message: error.message,\n        stack: error.stack,\n        hostId: pms.selectedHost.id\n    };\n    return io('console/errorHandler', error).then(function (response) {\n        return response.status;\n    });\n}\n\nexport function initPromise(result) {\n    return new Promise(function (resolve, reject) {\n        return resolve(result);\n    });\n}\n\nexport function importModule(moduleId) {\n    return initPromise(moduleId).then(function (moduleId) {\n        let module = pms.module[moduleId];\n        if (!module || !module.loaded) return getModuleData(moduleId).then(loadModule).catch(function (error) {\n            return false;\n        }).then(function (response) {\n            return true;\n        });\n        return true;\n    });\n}\n\n\n\n// WEBPACK FOOTER //\n// ./assets/js/workspace.js","import * as workspace from './workspace.js';\nimport * as auth from './auth.js';\n\nwindow.pms = {\n    config: {\n        apiUrl: 'https://cms.prakula.ru/api/v1/',\n        name: 'PRakula CMS',\n        icon: '/pms-console/assets/images/logo.small.png'\n    }\n};\nwindow.io = io;\nwindow.oldIo = oldIo;\nwindow.initApp = initApp;\n// require('../css/style.css');\n\nwindow.addEventListener('load', function () {\n    pms.config.isFramed = false;\n    try {\n        pms.config.isFramed = window != window.top || document != top.document || self.location != top.location;\n    } catch (e) {\n        pms.config.isFramed = true;\n    }\n    if (pms.config.isFramed) {\n        window.addEventListener('message', function (event) {\n            if (window.initTimeout) clearTimeout(window.initTimeout);\n            delete window.initTimeout;\n            if (typeof event.data === 'object') window.pmsHostData = event.data;\n            initApp();\n        });\n        window.initTimeout = setTimeout(function () {\n            initApp();\n        }, 1000);\n        window.parent.postMessage({status: true, get: 'pmsHostData'}, '*');\n    } else initApp();\n});\n\nfunction initApp() {\n    if (window.pmsHostData) pms.currentHost = window.pmsHostData;\n    // console.debug(pms);\n    return auth.check().then(function (response) {\n        if (response) {\n            return workspace.prepare();\n        } else {\n            return auth.showLogin();\n        }\n    });\n}\n\nfunction oldIo(method, data, post, url, plainData) {\n    url = url ? url : (pms.config.apiUrl ? pms.config.apiUrl : '/api/') + method;\n    if (!post) {\n        data = data ? data : '';\n        if (typeof data === 'object') data = Object.keys(data).map(function (k) {\n            return encodeURIComponent(k) + '=' + encodeURIComponent(data[k]);\n        }).join('&');\n    }\n    if (method) {\n        let token = localStorage.getItem('token') ?\n            localStorage.getItem('token') : false;\n        /*(pms.currentHost ?\n            (pms.currentHost.token ? pms.currentHost.token : false) :\n            false);*/\n        if (token) {\n            if (post) data['_token'] = token; else data += (data !== '' ? '&' : '') + '_token=' + token;\n        }\n    }\n    if (data !== '' && !post) url += '?' + data;\n    let parameters = {\n        method: (post ? 'POST' : 'GET'),\n        mode: 'cors',\n        credentials: 'include'\n    };\n    if (post) parameters.body = JSON.stringify(data);\n    return fetch(url, parameters).then(function (response) {\n        if (response.status >= 200 && response.status < 300) {\n            return response\n        } else {\n            return plainData ? false : {'status': false, 'error': response.statusText};\n        }\n    }).then(function (response) {\n        if (!response) return response;\n        if (plainData) return response.text(); else return response.json();\n    }).catch(function (response) {\n        let debugData = ['Response parse error'];\n        if (response.message) debugData.push(response.message);\n        if (method) debugData.push(method);\n        if (data !== '') debugData.push(method ? decodeURIComponent(data) : decodeURIComponent(url));\n        console.debug.apply(this, debugData);\n        return {'status': false, 'error': 'Response parse error'};\n    }).then(function (response) {\n        if (!response || response.error) return response;\n        let debugData = [response.offline ? 'Offline mode' : 'Request successful'];\n        if (method) debugData.push(method);\n        if (data !== '') debugData.push(method ? decodeURIComponent(data) : decodeURIComponent(url));\n        debugData.push(response);\n        console.debug.apply(this, debugData);\n        if (response.offline) initOfflineMode(); else pms.offline = false;\n        return response;\n    }).catch(function (error) {\n        console.error(error);\n        return {'status': false};\n    });\n}\n\nfunction io(method, getData, postData, url, plainData) {\n    url = url ? url : (pms.config.apiUrl ? pms.config.apiUrl : '/api/') + method;\n    getData = getData ? getData : '';\n    if (typeof getData === 'object') getData = serialize(getData);\n    postData = postData ? postData : false;\n    if (typeof postData === 'object') postData = serialize(postData);\n    if (method && !getCookie('token')) {\n        let token = localStorage.getItem('token');\n        if (token) {\n            getData += (getData !== '' ? '&' : '') + '_token=' + token;\n        }\n    }\n    if (getData !== '') url += '?' + getData;\n    let parameters = {\n        method: (postData ? 'POST' : 'GET'),\n        mode: 'cors',\n        credentials: 'include'\n    };\n    if (postData) parameters.body = postData;\n    return fetch(url, parameters).then(function (response) {\n        if (response.status >= 200 && response.status < 300) {\n            return response\n        } else {\n            return plainData ? false : {'status': false, 'error': response.statusText};\n        }\n    }).then(function (response) {\n        if (!response) return response;\n        if (plainData) return response.text(); else return response.json();\n    }).catch(function (response) {\n        let debugData = ['Response parse error'];\n        if (response.message) debugData.push(response.message);\n        if (method) debugData.push(method);\n        if (getData !== '') debugData.push(method ? decodeURIComponent(getData) : decodeURIComponent(url));\n        if (postData && method) debugData.push(decodeURIComponent(postData));\n        console.debug.apply(this, debugData);\n        return {'status': false, 'error': 'Response parse error'};\n    }).then(function (response) {\n        if (!response || response.error) return response;\n        let debugData = [response.offline ? 'Offline mode' : 'Request successful'];\n        if (method) debugData.push(method);\n        if (getData !== '') debugData.push(method ? decodeURIComponent(getData) : decodeURIComponent(url));\n        if (postData && method) debugData.push(decodeURIComponent(postData));\n        debugData.push(response);\n        console.debug.apply(this, debugData);\n        if (response.offline) initOfflineMode(); else pms.offline = false;\n        return response;\n    }).catch(function (error) {\n        console.error(error);\n        return {'status': false};\n    });\n}\n\nfunction serialize (obj, prefix) {\n    var str = [], p;\n    for(p in obj) {\n        if (obj.hasOwnProperty(p)) {\n            var k = prefix ? prefix + \"[\" + p + \"]\" : p, v = obj[p];\n            str.push((v !== null && typeof v === \"object\") ?\n                serialize(v, k) :\n                encodeURIComponent(k) + \"=\" + encodeURIComponent(v));\n        }\n    }\n    return str.join(\"&\");\n}\n\nfunction getCookie(name) {\n    let matches = document.cookie.match(new RegExp(\n        \"(?:^|; )\" + name.replace(/([\\.$?*|{}\\(\\)\\[\\]\\\\\\/\\+^])/g, '\\\\$1') + \"=([^;]*)\"\n    ));\n    return matches ? decodeURIComponent(matches[1]) : undefined;\n}\n\nfunction initOfflineMode() {\n    if (pms.offline === true) return true;\n    pms.offline = true;\n    alert('Мы потеряли соединение с сервером, проверьте подключение и повторите');\n    return true\n}\n\n\n// WEBPACK FOOTER //\n// ./assets/js/init.js","import * as workspace from './workspace.js';\n\nlet template = {};\n\nwindow.auth = {logout: logout};\n\nexport function check() {\n    return io('console/getUserData').then(function (response) {\n        if (response.status) saveUserData(response);\n        return response.status;\n    });\n}\n\nexport function send(login, password) {\n    // auth.loginSection.classList.toggle('incorrect-data', false);\n    return new Promise(function (resolve, reject) {\n        if (!login || login === '') return resolve(loginError('empty_login', 'login'));\n        if (!login || password === '') return resolve(loginError('empty_password', 'password'));\n        showItemLoadIndicator('auth', 'login-button');\n        let data = {login: login, password: password};\n        return resolve(io('console/auth', data));\n    });\n}\n\n\nfunction loginError(message, type) {\n    // return new Promise(function (resolve, reject) {\n    let authLogin = document.getElementById('auth-login');\n    let loginMessage = document.getElementById('auth-login-message');\n    let authPassword = document.getElementById('auth-password');\n    let passwordMessage = document.getElementById('auth-password-message');\n    if (type) switch (type) {\n        case 'login':\n            switch (message) {\n                case 'empty_login':\n                    loginMessage.innerText = 'Необходимо ввести ваш логин';\n                    break;\n            }\n            authLogin.classList.toggle('highlight', true);\n            break;\n        case 'password':\n            switch (message) {\n                case 'empty_password':\n                    passwordMessage.innerText = 'Необходимо ввести ваш пароль';\n                    break;\n                case 'incorrect_data':\n                    passwordMessage.innerText = 'Указан неверный пароль';\n                    break;\n            }\n            authPassword.classList.toggle('highlight', true);\n            break;\n        case 'all':\n            switch (message) {\n                case 'bad_parameters':\n                    loginMessage.innerText = 'Необходимо ввести ваш логин';\n                    passwordMessage.innerText = 'Необходимо ввести ваш пароль';\n                    break;\n            }\n            authLogin.classList.toggle('highlight', true);\n            authPassword.classList.toggle('highlight', true);\n\n    }\n    hideItemLoadIndicator('auth', 'login-button');\n    setProgress('auth-button', false);\n    auth.loginSection.classList.toggle('incorrect-data', true);\n    setTimeout(function () {\n        auth.loginSection.classList.toggle('incorrect-data', false);\n    }, 500);\n    console.log(message ? message : type);\n    return false;// resolve(false);\n    // });\n}\n\nexport function showLogin() {\n    if (!template.login) return workspace.loadTemplate('login')\n        .then(function (response) {\n            if (!response) return 'Не удалось загрузить страницу';\n            return template.login = response;\n        }).then(workspace.render).then(prepareLogin); else\n        return workspace.render(template.login)\n            .then(prepareLogin);\n}\n\nfunction prepareLogin() {\n    if (pms.currentHost) {\n        if (pms.currentHost.title && document.getElementById('host-name')) document.getElementById('host-name').innerText = pms.currentHost.title;\n        if (pms.currentHost.logo && document.getElementById('host-logo')) document.getElementById('host-logo').src = pms.currentHost.logo;\n        if (pms.currentHost.homePage && document.getElementById('home-page')) document.getElementById('home-page').href = pms.currentHost.homePage;\n    }\n    if (document.getElementById('login-section')) auth.loginSection = document.getElementById('login-section');\n    if (document.getElementById('auth-button')) document.getElementById('auth-button').addEventListener('click', function () {\n        if (isProgress('auth-button')) return false;\n        if (!document.getElementById('auth-login') || !document.getElementById('auth-password')) return false;\n        document.getElementById('auth-login').classList.toggle('highlight', false);\n        document.getElementById('auth-login-message').innerText = '';\n        document.getElementById('auth-password').classList.toggle('highlight', false);\n        document.getElementById('auth-password-message').innerText = '';\n        setProgress('auth-button');\n        showLoadingIndicator();\n        return send(document.getElementById('auth-login').value, document.getElementById('auth-password').value).then(function (response) {\n            if (!response) return false;\n            if (!response.status) return loginError('incorrect_data', 'password');\n            if (response.token) {\n                localStorage.setItem('token', response.token);\n                /*if (pms.config.isFramed) window.parent.postMessage({\n                    status: true,\n                    set: 'token',\n                    data: response.token\n                }, '*');*/\n            }\n            pms.onLeavePage.push(function () {\n                hideItemLoadIndicator('auth', 'login-button');\n            });\n            saveUserData(response);\n            return workspace.prepare();\n        }).then(hideLoadingIndicator).then(function () {\n            return setProgress('auth-button', false);\n        });\n    });\n    return true;\n}\n\nfunction saveUserData(response) {\n    if (!response || !response.status) return false;\n    pms.userData = {};\n    if (response.userId) pms.userData.id = response.userId;\n    if (response.login) pms.userData.login = response.login;\n    if (response.email) pms.userData.email = response.email;\n    if (response.firstname) pms.userData.firstname = response.firstname;\n    if (response.lastname) pms.userData.lastname = response.lastname;\n    if (response.avamoji) pms.userData.avamoji = response.avamoji;\n\n    let OneSignal = window.OneSignal || [];\n    OneSignal.push([\"init\", {\n        appId: \"d6d3da7e-593f-4b75-a598-a5d4b27e31e6\",\n        autoRegister: true,\n        notifyButton: {\n            enable: false,\n        },\n        promptOptions: {\n            actionMessage: \"Уведомим о важных событиях связанных с сайтом, продвижением страниц и других изменениях\",\n            acceptButtonText: \"Получать\",\n            cancelButtonText: \"Отказаться\"\n        }\n    }]);\n    return true;\n}\n\nfunction logout() {\n    return io('console/logout').then(function (response) {\n        if (response && response.status) {\n            window.pms = {\n                config: pms.config\n            };\n            localStorage.clear();\n            return showLogin();\n        } else alert('Произошла ошибка');\n    })\n}\n\n\n// WEBPACK FOOTER //\n// ./assets/js/auth.js"],"sourceRoot":""}