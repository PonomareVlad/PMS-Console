{"version":3,"sources":["webpack:///webpack/bootstrap 8b1a8fc63431d7fd7df3","webpack:///./assets/js/workspace.js","webpack:///./assets/js/init.js","webpack:///./assets/js/auth.js"],"names":["init","prepare","loadTemplate","render","updateHostsData","renderHostsSelectMenu","loadHost","getHostModules","getModuleData","loadModule","loadMenu","menuItemClick","showItemLoadIndicator","hideItemLoadIndicator","showLoadingIndicator","hideLoadingIndicator","leavePage","selectHost","isProgress","setProgress","renderMenuItems","getHostUrl","loadNotifications","renderNotifications","notifyAction","removeNotification","createNotification","showNotification","errorHandler","initPromise","template","window","workspace","require","onerror","message","url","lineNumber","arguments","pms","onLeavePage","appearance","loadIndicators","progressState","addEventListener","onFirstTouch","document","body","classList","toggle","removeEventListener","test","navigator","userAgent","MSStream","iOS","standalone","toLowerCase","indexOf","macOs","script","io","then","response","eval","apply","e","console","error","wrapper","alert","prepareWrapper","selectedHost","title","getElementById","innerText","logo","src","homePage","href","currentHost","value","toggleMobileMenu","userName","userData","firstname","lastname","login","avamoji","menu","notificationsWrapper","id","html","node","Promise","resolve","reject","innerHTML","status","hostsData","domainsHost","i","domain","outputSource","hostsDataKeys","Object","keys","host","menuNode","length","parentNode","style","display","modules","hostId","menuStructure","modulesData","moduleData","module","push","moduleId","loaded","menuSource","menu_item_title","description","itemId","parameters","type","menu_item_type","catch","workspaceGenerator","debug","statusText","result","menuItemsWorker","menuItems","attribute","item","querySelectorAll","loader","querySelector","setTimeout","recursion","removeChild","cursor","state","menuId","items","container","JSON","stringify","excludePath","hostData","https","path","notifications","notification","notificationsSource","icon","time","actions","action","notificationId","actionId","local","method","closeAfter","parseInt","splice","Date","getTime","data","notificationSource","close","report","errorReport","config","stack","auth","apiUrl","name","oldIo","initApp","isFramed","top","self","location","event","initTimeout","clearTimeout","pmsHostData","parent","postMessage","get","check","showLogin","post","plainData","map","k","encodeURIComponent","join","token","localStorage","getItem","mode","credentials","fetch","text","json","debugData","decodeURIComponent","offline","initOfflineMode","getData","postData","serialize","getCookie","obj","prefix","str","p","hasOwnProperty","v","matches","cookie","match","RegExp","replace","undefined","send","logout","saveUserData","password","loginError","authLogin","loginMessage","authPassword","passwordMessage","loginSection","log","prepareLogin","setItem","userId","email","OneSignal","appId","autoRegister","notifyButton","enable","promptOptions","actionMessage","acceptButtonText","cancelButtonText","clear"],"mappings":"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","file":"init.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"/pms-console/\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 1);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap 8b1a8fc63431d7fd7df3","let template = {};\n\nwindow.menuItemClick = menuItemClick;\nwindow.workspace = {render: render, loadTemplate: loadTemplate, require: require, leavePage: leavePage, init: init};\nwindow.showLoadingIndicator = showLoadingIndicator;\nwindow.hideLoadingIndicator = hideLoadingIndicator;\nwindow.showItemLoadIndicator = showItemLoadIndicator;\nwindow.hideItemLoadIndicator = hideItemLoadIndicator;\nwindow.selectHost = selectHost;\nwindow.isProgress = isProgress;\nwindow.setProgress = setProgress;\nwindow.getHostUrl = getHostUrl;\nwindow.notifyAction = notifyAction;\nwindow.createNotification = createNotification;\nwindow.showNotification = showNotification;\nwindow.errorHandler = errorHandler;\nwindow.initPromise = initPromise;\n\nwindow.onerror = function (message, url, lineNumber) {\n    return errorHandler(arguments, message);\n    /*alert(\"Поймана ошибка, выпавшая в глобальную область!\\n\" +\n        \"Сообщение: \" + message + \"\\n(\" + url + \":\" + lineNumber + \")\");*/\n};\n\nexport function init() {\n    if (!pms.workspace) pms.workspace = {};\n    if (!pms.onLeavePage) pms.onLeavePage = [];\n    if (!pms.appearance) pms.appearance = {};\n    if (!pms.appearance.loadIndicators) pms.appearance.loadIndicators = {};\n    if (!pms.progressState) pms.progressState = {};\n\n    window.addEventListener('touchstart', function onFirstTouch() {\n        document.body.classList.toggle('touchscreen', true);\n        window.removeEventListener('touchstart', onFirstTouch, false);\n    }, false);\n\n    if (/iPad|iPhone|iPod/.test(navigator.userAgent) && !window.MSStream) {\n        pms.workspace.iOS = true;\n        if ((\"standalone\" in window.navigator) && window.navigator.standalone) document.body.classList.toggle('ios-standalone', true);\n    } else if (navigator.userAgent.toLowerCase().indexOf('safari') !== -1 && navigator.userAgent.toLowerCase().indexOf('chrome') < 0) {\n        pms.workspace.macOs = true;\n    } else {\n        document.body.classList.toggle('material', true);\n    }\n}\n\nexport function require(script) {\n    return io(false, false, false, './assets/js/' + script + '.js', true)\n        .then(function (response) {\n            if (!response) return false;\n            try {\n                eval.apply(window, [response]);\n            } catch (e) {\n                console.error(e);\n                return false;\n            }\n            return true;\n        })\n}\n\nexport function prepare() {\n    init();\n    showLoadingIndicator();\n    if (!template.wrapper) return loadTemplate('wrapper')\n        .then(function (response) {\n            if (!response) {\n                alert('Не удалось загрузить страницу');\n                return false;\n            }\n            return template.wrapper = response;\n        })\n        // .then(prepareWrapper)\n        .then(updateHostsData).then(function () {\n            return render(template.wrapper);\n        })\n        .then(loadHost)\n        .then(renderHostsSelectMenu).then(loadNotifications)\n        .then(hideLoadingIndicator);\n    else\n        return updateHostsData().then(function () {\n            return render(template.wrapper);\n        })\n            .then(loadHost)\n            .then(renderHostsSelectMenu).then(loadNotifications)\n            .then(hideLoadingIndicator);\n}\n\nfunction prepareWrapper() {\n    if (pms.selectedHost) {\n        if (pms.selectedHost.title && document.getElementById('host-name'))\n            document.getElementById('host-name').innerText = pms.selectedHost.title;\n        if (pms.selectedHost.logo && document.getElementById('host-logo'))\n            document.getElementById('host-logo').src = pms.selectedHost.logo;\n        if (pms.selectedHost.homePage && document.getElementById('home-page'))\n            document.getElementById('home-page').href = pms.selectedHost.homePage;\n    } else if (pms.currentHost) {\n        if (pms.currentHost.title && document.getElementById('host-name'))\n            document.getElementById('host-name').innerText = pms.currentHost.title;\n        if (pms.currentHost.logo && document.getElementById('host-logo'))\n            document.getElementById('host-logo').src = pms.currentHost.logo;\n        if (pms.currentHost.homePage && document.getElementById('home-page'))\n            document.getElementById('home-page').href = pms.currentHost.homePage;\n    }\n    if (document.getElementById('select-hosts-menu')) document.getElementById('select-hosts-menu').addEventListener('change', function () {\n        selectHost(this.value);\n    });\n    if (document.getElementById('header-menu-button')) document.getElementById('header-menu-button').addEventListener('click', toggleMobileMenu);\n    let userName = pms.userData.firstname ? pms.userData.firstname + (pms.userData.lastname ? ' ' + pms.userData.lastname : '') : (pms.userData.login ? pms.userData.login : 'Любимый пользователь');\n    if (document.getElementById('user-name')) document.getElementById('user-name').innerText = userName;\n    if (pms.userData.avamoji && document.getElementById('user-avamoji')) document.getElementById('user-avamoji').innerText = pms.userData.avamoji;\n    if (document.getElementById('workspace-menu'))\n        pms.workspace.menu = document.getElementById('workspace-menu');\n    if (document.getElementById('workspace-wrapper'))\n        pms.workspace.wrapper = document.getElementById('workspace-wrapper');\n    if (document.getElementById('notificationsWrapper')) {\n        pms.workspace.notificationsWrapper = document.getElementById('notificationsWrapper');\n    }\n    return true;\n}\n\nexport function loadTemplate(id) {\n    return io(false, false, false, './' + id + '.html', true)\n        .then(function (response) {\n            if (typeof response !== 'string') return false;\n            else return response;\n        });\n}\n\nexport function render(html, node = document.body) {\n    init();\n    leavePage(); /// FUUUCK!!!!\n    return new Promise(function (resolve, reject) {\n        if (!html) return false;\n        node.innerHTML = html;\n        return resolve(node);\n    });\n}\n\nexport function updateHostsData() {\n    return io('console/getHosts').then(function (response) {\n        if (!response.status) return false;\n        if (response.hostsData) {\n            if (!pms.hostsData) pms.hostsData = {};\n            if (!pms.domainsHost) pms.domainsHost = {};\n            for (let i in response.hostsData) {\n                pms.hostsData[response.hostsData[i].id] = response.hostsData[i];\n                pms.domainsHost[response.hostsData[i].domain] = response.hostsData[i];\n            }\n        }\n        return true;\n    })\n}\n\nexport function renderHostsSelectMenu() {\n    let outputSource = '<option selected disabled>🌐 Выбрать Сайт</option>';\n    let hostsDataKeys = Object.keys(pms.hostsData);\n    for (let i in hostsDataKeys) {\n        let host = pms.hostsData[hostsDataKeys[i]];\n        let title = host.title ? host.title : host.domain;\n        //let active = pms.selectedHost ? (pms.selectedHost.id === host.id ? 'selected' : '') : '';\n        outputSource += '<option value=\"' + host.id + '\" ' + '>' + title + '</option>';\n    }\n    let menuNode = document.getElementById('select-hosts-menu');\n    menuNode.innerHTML = outputSource;\n    if (hostsDataKeys.length > 1) menuNode.parentNode.style.display = 'initial';\n    else menuNode.parentNode.style.display = 'none';\n    return true;\n}\n\nexport function loadHost(id) {\n    leavePage();\n    return new Promise(function (resolve, reject) {\n        if (!pms.hostsData) return resolve(false);\n        if (!id || !(typeof id === \"string\" || typeof id === \"number\")) {\n            id = false;\n            if (pms.currentHost && pms.currentHost.domain)\n                if (pms.domainsHost[pms.currentHost.domain]) id = pms.domainsHost[pms.currentHost.domain].id;\n            id = id ? id : Object.keys(pms.hostsData)[0];\n        }\n        let host = pms.selectedHost = pms.hostsData[id];\n        if (!host.modules) return resolve(getHostModules(host.id).then(function (response) {\n            if (!response) return response;\n            return host;\n        }).then(prepareWrapper).then(loadMenu));\n        return resolve(new Promise(function (resolve, reject) {\n            return resolve(prepareWrapper());\n        }).then(loadMenu));\n    });\n}\n\nexport function getHostModules(hostId) {\n    return io('console/getModules', {hostId: hostId}).then(function (response) {\n        if (!response.status) return false;\n        let host = pms.hostsData[hostId];\n        host.menuStructure = [];\n        if (!host.modules) host.modules = {};\n        for (let i in response.modulesData) {\n            let moduleData = response.modulesData[i];\n            if (!pms.module) pms.module = {};\n            if (!pms.module[moduleData.id]) pms.module[moduleData.id] = moduleData;\n            host.modules[moduleData.id] = pms.module[moduleData.id];\n            host.menuStructure.push(host.modules[moduleData.id]);\n        }\n        return true;\n    })\n}\n\nexport function getModuleData(moduleId, hostId = false) {\n    hostId = hostId ? hostId : pms.selectedHost.id;\n    // console.debug('getModuleData', moduleId, hostId);\n    return new Promise(function (resolve, reject) {\n        if (pms.hostsData[hostId].modules[moduleId].init) return resolve(moduleId);\n        else return resolve(io('console/getModuleData', {\n            moduleId: moduleId,\n            hostId: hostId\n        }).then(function (response) {\n            if (!response.status || !response.init) return false;\n            let host = pms.hostsData[hostId];\n            host.modules[moduleId].init = response.init;\n            return moduleId;\n        }));\n    });\n}\n\nexport function loadModule(moduleId) {\n    return new Promise(function (resolve, reject) {\n        if (!pms.module[moduleId] || !pms.module[moduleId].init) return resolve(false);\n        if (pms.module[moduleId].loaded) return resolve(true);\n        try {\n            eval(pms.module[moduleId].init);\n        } catch (e) {\n            reject(e);\n        }\n        pms.module[moduleId].loaded = true;\n        return resolve(true);\n    });\n}\n\nexport function loadMenu() {\n    if (!pms.selectedHost || !pms.selectedHost.modules) return false;\n    let modules = pms.selectedHost.menuStructure ? pms.selectedHost.menuStructure : pms.selectedHost.modules;\n    let menuSource = '<h2>Меню:</h2><ul>';\n    for (let i in modules) {\n        let module = pms.module[modules[i].id];\n        let title = module.menu_item_title ? module.menu_item_title : (module.title ? module.title : module.id);\n        let description = module.description ? ('<p>' + module.description + '</p>') : '';\n        menuSource += '<li data-menu-item=\"' + module.id + '\" onclick=\"menuItemClick(\\'' + module.id + '\\')\"><a href=\"javascript:void(0);\"><span>' + title + '</span>' + description + '</a>' + '</li><ul data-menu-item-container=\"' + module.id + '\"></ul>';\n    }\n    menuSource += '</ul>';\n    if (pms.workspace.menu) pms.workspace.menu.innerHTML = menuSource;\n    return true;\n}\n\nexport function menuItemClick(moduleId = false, itemId = false, parameters = false, type = false) {\n    if (isProgress('menuItem')) return false;\n    setProgress('menuItem');\n    let module = pms.module[moduleId];\n    if (!itemId) itemId = moduleId;\n    showItemLoadIndicator(itemId, 'menu-item');\n    showLoadingIndicator();\n    if (!parameters) {\n        if (module.menu_item_type && module.menu_item_type === 'item') {\n            if (!module.loaded) getModuleData(moduleId).then(loadModule).catch(function (error) {\n                return false;\n            }).then(function (response) {\n                if (!response || !module.loaded) alert('Раздел временно недоступен');\n                if (module.workspaceGenerator) return module.workspaceGenerator();\n                return {status: true};\n            }).then(function (response) {\n                if (typeof response !== 'object') return false;\n                if (!response.status) console.debug(moduleId, response.statusText ? response.statusText : response);\n                return true;\n            }).then(function (result) {\n                setProgress('menuItem', false);\n                hideLoadingIndicator();\n                hideItemLoadIndicator(itemId, 'menu-item');\n                toggleMobileMenu(false);\n                return result;\n            });\n            else if (module.workspaceGenerator)\n                return module.workspaceGenerator()\n                    .then(function (result) {\n                        setProgress('menuItem', false);\n                        hideLoadingIndicator();\n                        hideItemLoadIndicator(itemId, 'menu-item');\n                        toggleMobileMenu(false);\n                        return result;\n                    });\n        } else if (module.menu_item_type && module.menu_item_type === 'group') {\n            if (!module.loaded) getModuleData(moduleId).then(loadModule).catch(function (error) {\n                return false;\n            }).then(function (response) {\n                if (!response || !module.loaded) alert('Раздел временно недоступен');\n                if (module.menuItemsWorker) return module.menuItemsWorker();\n                return {status: true};\n            }).then(function (response) {\n                // console.debug(response);\n                if (typeof response !== 'object') return false;\n                if (!response.status) console.debug(moduleId, response.statusText ? response.statusText : response);\n                return response.menuItems ? renderMenuItems(moduleId, itemId, response.menuItems) : true;\n            }).then(function (result) {\n                setProgress('menuItem', false);\n                hideLoadingIndicator();\n                hideItemLoadIndicator(itemId, 'menu-item');\n                return result;\n            });\n            else if (module.menuItemsWorker)\n                return module.menuItemsWorker().then(function (response) {\n                    console.debug(response);\n                    if (typeof response !== 'object') return false;\n                    if (!response.status) console.debug(moduleId, response.statusText ? response.statusText : response);\n                    return response.menuItems ? renderMenuItems(moduleId, itemId, response.menuItems) : true;\n                }).then(function (result) {\n                    setProgress('menuItem', false);\n                    hideLoadingIndicator();\n                    hideItemLoadIndicator(itemId, 'menu-item');\n                    return result;\n                });\n            setProgress('menuItem', false);\n            hideLoadingIndicator();\n            hideItemLoadIndicator(itemId, 'menu-item');\n        }\n    } else {\n        if (!type) {\n\n        } else {\n            // console.debug(moduleId, parameters, type);\n            if (type === 'item') {\n                if (module.workspaceGenerator)\n                    return module.workspaceGenerator(parameters)\n                        .catch(errorHandler)\n                        .then(function (result) {\n                            setProgress('menuItem', false);\n                            hideLoadingIndicator();\n                            hideItemLoadIndicator(itemId, 'menu-item');\n                            toggleMobileMenu(false);\n                            return result;\n                        });\n            } else if (type === 'group') {\n                if (module.menuItemsWorker)\n                    return module.menuItemsWorker(parameters)\n                        .catch(errorHandler)\n                        .then(function (response) {\n                            // console.debug('menuItemClick (ItemsWorker)', response);\n                            setProgress('menuItem', false);\n                            hideLoadingIndicator();\n                            hideItemLoadIndicator(itemId, 'menu-item');\n                            return response.menuItems ? renderMenuItems(moduleId, itemId, response.menuItems) : true;\n                        });\n            }\n        }\n    }\n}\n\nexport function showItemLoadIndicator(id, attribute) {\n    if (!pms.appearance) pms.appearance = {};\n    if (!pms.appearance.loadIndicators) pms.appearance.loadIndicators = {};\n    let item = document.querySelectorAll('[data-' + attribute + '=\"' + id + '\"]');\n    if (!item || item.length === 0) return false;\n    if (pms.appearance.loadIndicators[attribute + '-' + id]) return false; //else console.debug('showItemLoadIndicator', 'indicator for ' + attribute + '-' + id + ' already active', pms.appearance.loadIndicators[attribute + '-' + id], pms.appearance);\n    pms.appearance.loadIndicators[attribute + '-' + id] = 'initShow';\n    item = item[0];\n    let loader = item.querySelector('.loader-spinner-wrapper');\n    if (!loader || loader.length === 0) {\n        item.innerHTML += `<div class=\"loader-spinner-wrapper\">\n<div class=\"ispinner ispinner--gray ispinner--animating\">\n  <div class=\"ispinner__blade\"></div>\n  <div class=\"ispinner__blade\"></div>\n  <div class=\"ispinner__blade\"></div>\n  <div class=\"ispinner__blade\"></div>\n  <div class=\"ispinner__blade\"></div>\n  <div class=\"ispinner__blade\"></div>\n  <div class=\"ispinner__blade\"></div>\n  <div class=\"ispinner__blade\"></div>\n  <div class=\"ispinner__blade\"></div>\n  <div class=\"ispinner__blade\"></div>\n  <div class=\"ispinner__blade\"></div>\n  <div class=\"ispinner__blade\"></div>\n</div></div>`\n    }\n    setTimeout(function () {\n        item.classList.toggle('loader-spinner-active', true);\n        pms.appearance.loadIndicators[attribute + '-' + id] = 'show';\n    }, 100);\n}\n\nexport function hideItemLoadIndicator(id, attribute, recursion) {\n    if (pms.appearance.loadIndicators[attribute + '-' + id] && pms.appearance.loadIndicators[attribute + '-' + id] === 'initShow') {\n        if (!recursion) setTimeout(function () {\n            hideItemLoadIndicator(id, attribute, true)\n        }, 100);\n        return false;\n    }\n    pms.appearance.loadIndicators[attribute + '-' + id] = 'initHide';\n    let item = document.querySelector('[data-' + attribute + '=\"' + id + '\"]');\n    if (!item || item.length === 0) {\n        pms.appearance.loadIndicators[attribute + '-' + id] = false;\n        delete pms.appearance.loadIndicators[attribute + '-' + id];\n        return false;\n    }\n    item.classList.toggle('loader-spinner-active', false);\n    setTimeout(function () {\n        let item = document.querySelector('[data-' + attribute + '=\"' + id + '\"]');\n        if (!item || item.length === 0) {\n            pms.appearance.loadIndicators[attribute + '-' + id] = false;\n            delete pms.appearance.loadIndicators[attribute + '-' + id];\n            return false;\n        }\n        let loader = item.querySelector('.loader-spinner-wrapper');\n        if (loader && loader.length > 0) {\n            loader[0].parentNode.removeChild(loader[0]);\n        }\n        pms.appearance.loadIndicators[attribute + '-' + id] = false;\n        delete pms.appearance.loadIndicators[attribute + '-' + id];\n    }, 500);\n}\n\nexport function showLoadingIndicator(result = true) {\n    document.body.style.cursor = 'progress';\n    return result;\n}\n\nexport function hideLoadingIndicator(result = true) {\n    document.body.style.cursor = 'default';\n    return result;\n}\n\nexport function leavePage() {\n    return new Promise(function (resolve, reject) {\n        if (!pms.onLeavePage) pms.onLeavePage = [];\n        for (let i in pms.onLeavePage) if (typeof pms.onLeavePage[i] === \"function\") try {\n            pms.onLeavePage[i]();\n        } catch (e) {\n            console.error(e);\n        }\n        pms.onLeavePage = [];\n        resolve(true);\n    });\n}\n\nexport function selectHost(id) {\n    return render(template.wrapper)\n    // .then(prepareWrapper)\n        .then(function () {\n            return loadHost(id);\n        }).then(renderHostsSelectMenu)\n        .then(hideLoadingIndicator);\n}\n\nexport function isProgress(id) {\n    return pms.progressState[id];\n}\n\nexport function setProgress(id, state = true) {\n    pms.progressState[id] = state;\n    if (!state) delete pms.progressState[id];\n    return true;\n}\n\nexport function renderMenuItems(moduleId, menuId, items) {\n    let container = document.querySelectorAll('[data-menu-item-container=\"' + menuId + '\"]');\n    if (!container || container.length === 0) return false;\n    let menuSource = '';\n    for (let i in items) {\n        let item = items[i];\n        let title = item.menu_item_title ? item.menu_item_title : (item.title ? item.title : item.id);\n        let description = item.description ? ('<p>' + item.description + '</p>') : '';\n        let parameters = item.parameters ? item.parameters : {};\n        if (!item['type']) item['type'] = 'item';\n        parameters['id'] = item.id;\n        menuSource += '<li data-menu-item=\"' + item.id + '\" onclick=\\'menuItemClick(\"' + moduleId + '\",\"' + item.id + '\",' + JSON.stringify(parameters) + ',\"' + item.type + '\")\\'><a href=\"javascript:void(0);\"><span>' + title + '</span>' + description + '</a>' + '</li><ul data-menu-item-container=\"' + item.id + '\"></ul>';\n    }\n    if (container[0]) container[0].innerHTML = menuSource;\n    return true;\n}\n\nexport function getHostUrl(excludePath, hostId) {\n    if (!hostId) hostId = pms.selectedHost.id;\n    let hostData = pms.hostsData[hostId];\n    return (hostData.https ? 'https://' : 'http://') + hostData.domain + (!excludePath && hostData.path ? hostData.path + '/' : '');\n}\n\nexport function loadNotifications(result) {\n    if (!pms.userData.notifications) pms.userData.notifications = [];\n    io('console/getUserNotifications').then(function (response) {\n        if (!response.status || !response.notifications) return false;\n        pms.notifications = response.notifications;\n        if (!pms.notification) pms.notification = {};\n        for (let i in pms.notifications) if (pms.notifications[i].id) pms.notification[pms.notifications[i].id] = pms.notifications[i];\n        return true;\n    }).then(renderNotifications);\n    return result;\n}\n\nexport function renderNotifications() {\n    if (!pms.workspace.notificationsWrapper) return false;\n    if (!pms.notifications || pms.notifications.length === 0) return true;\n    let notificationsSource = '';\n    for (let i in pms.notifications) {\n        let notification = pms.notifications[i];\n        if (!notification.id) continue;\n        notificationsSource += '<div class=\"notification background-blur\" data-notification=\"' + notification.id + '\"><div class=\"notification-data\"><div class=\"notification-header\"><div class=\"notification-header-side\">';\n        if (notification.icon) notificationsSource += '<figure style=\"background-image: url(' + notification.icon + ')\"></figure>';\n        if (notification.title) notificationsSource += '<span>' + notification.title + '</span>';\n        notificationsSource += '</div>';\n        if (notification.time) notificationsSource += '<div class=\"notification-header-side\"><span>' + notification.time + '</span></div>';\n        notificationsSource += '</div>';\n        if (notification.body) notificationsSource += '<div class=\"notification-body\">' + notification.body + '</div>';\n        notificationsSource += '</div><div class=\"notification-control\">';\n        if (notification.actions) {\n            for (let i in notification.actions) {\n                let action = notification.actions[i];\n                notificationsSource += '<button class=\"notification-control-item\" data-notification-action=\"' + notification.id + '_' + action.id + '\" onclick=\"notifyAction(\\'' + notification.id + '\\',\\'' + action.id + '\\');\">' + action.title + '</button>';\n            }\n        } else notificationsSource += '<button class=\"notification-control-item\" data-notification-action=\"' + notification.id + '_close\" onclick=\"notifyAction(\\'' + notification.id + '\\',\\'close\\');\">Закрыть</button>';\n        notificationsSource += '</div></div>';\n    }\n    pms.workspace.notificationsWrapper.innerHTML = notificationsSource;\n    return true;\n}\n\nexport function notifyAction(notificationId, actionId) {\n    if (!notificationId || !pms.notification[notificationId]) return false;\n    if (isProgress('notification_' + notificationId)) return false;\n    setProgress('notification_' + notificationId);\n    let notification = pms.notification[notificationId];\n    if (!actionId || actionId === 'close') {\n        if (notification.local) {\n            setProgress('notification_' + notificationId, false);\n            return removeNotification(notification.id);\n        }\n        showItemLoadIndicator(notificationId + '_' + actionId, 'notification-action');\n        return io('console/closeUserNotification', {'notification': notificationId}).then(function (response) {\n            // if (!response) return false;\n            hideItemLoadIndicator(notificationId + '_' + actionId, 'notification-action');\n            setProgress('notification_' + notificationId, false);\n            return removeNotification(notification.id);\n        });\n    } else if (notification.actions[actionId]) {\n        // TODO: Notification actions Here\n        return new Promise(function (resolve, reject) {\n            let action = notification.actions[actionId];\n            resolve(function () {\n                showItemLoadIndicator(notificationId + '_' + actionId, 'notification-action');\n                if (action.method) return action.method(action.parameters ? action.parameters : false);\n                return true;\n            }().then(function (result) {\n                if (!result) return result;\n                return action.closeAfter ? result : io('console/closeUserNotification', {'notification': notificationId})\n                    .then(function (response) {\n                        // hideItemLoadIndicator(notificationId + '_' + actionId, 'notification-action');\n                        // setProgress('notification_' + notificationId, false);\n                        return removeNotification(notification.id).then(function () {\n                            return result;\n                        });\n                    });\n            }).then(function () {\n                hideItemLoadIndicator(notificationId + '_' + actionId, 'notification-action');\n                setProgress('notification_' + notificationId, false);\n            }));\n        });\n\n    } else {\n        setProgress('notification_' + notificationId, false);\n        return false;\n    }\n}\n\nexport function removeNotification(notificationId) {\n    if (!notificationId) return false;\n    let notifications = document.querySelectorAll('[data-notification=\"' + notificationId + '\"]');\n    if (notifications && notifications.length > 0) /*for (let i in notifications) if (notifications[i]) notifications[i].parentNode.removeChild(notifications[i]);*/ notifications[0].parentNode.removeChild(notifications[0]);\n    if (pms.notification[notificationId]) {\n        pms.notification[notificationId] = false;\n        delete pms.notification[notificationId];\n    }\n    for (let i in pms.notifications) if (parseInt(pms.notifications[i].id) === parseInt(notificationId)) {\n        pms.notifications.splice(i, 1);\n        break;\n    }\n    return true;\n}\n\nexport function createNotification(title, body, icon, id, actions) {\n    /*actions = [\n        {\n            id: 'report',\n            title: 'Отчет',\n            method: reportPluginError,\n            parameters: {message: 'Error message', plugin: 12, time: new Date().getTime()}\n        }\n    ];*/\n    id = id ? (pms.notification[id] ? new Date().getTime() : id) : new Date().getTime();\n    let data = {\n        id: id,\n        title: title ? title : false,\n        body: body ? body : false,\n        icon: icon ? icon : false,\n        actions: actions ? actions : false,\n        // time: 'Сейчас',\n        local: true\n    };\n    pms.notification[id] = data;\n    return showNotification(data);\n}\n\nexport function showNotification(data) {\n    if (!pms.workspace.notificationsWrapper || !data) return false;\n    let notificationSource = '';\n    let notification = data;\n    if (!notification.id) return false;\n    notificationSource += '<div class=\"notification background-blur\" data-notification=\"' + notification.id + '\"><div class=\"notification-data\"><div class=\"notification-header\"><div class=\"notification-header-side\">';\n    if (notification.icon) notificationSource += '<figure style=\"background-image: url(' + notification.icon + ')\"></figure>';\n    if (notification.title) notificationSource += '<span>' + notification.title + '</span>';\n    notificationSource += '</div>';\n    if (notification.time) notificationSource += '<div class=\"notification-header-side\"><span>' + notification.time + '</span></div>';\n    notificationSource += '</div>';\n    if (notification.body) notificationSource += '<div class=\"notification-body\">' + notification.body + '</div>';\n    notificationSource += '</div><div class=\"notification-control\">';\n    if (notification.actions) {\n        for (let i in notification.actions) {\n            let action = notification.actions[i];\n            notificationSource += '<button class=\"notification-control-item\" data-notification-action=\"' + notification.id + '_' + i + '\" onclick=\"notifyAction(\\'' + notification.id + '\\',\\'' + i + '\\');\">' + action.title + '</button>';\n        }\n    } else notificationSource += '<button class=\"notification-control-item\" data-notification-action=\"' + notification.id + '_close\" onclick=\"notifyAction(\\'' + notification.id + '\\',\\'close\\');\">Закрыть</button>';\n    notificationSource += '</div></div>';\n    pms.workspace.notificationsWrapper.innerHTML += notificationSource;\n    return true;\n}\n\nfunction toggleMobileMenu(state) {\n    if (typeof state === \"boolean\") document.body.classList.toggle('mobile-menu-show', state);\n    else document.body.classList.toggle('mobile-menu-show');\n}\n\nexport function errorHandler(error, message, title, icon) {\n    console.error(message, error);\n    let actions = {\n        close: {\n            id: 'close',\n            title: 'Закрыть'\n        },\n        report: {\n            id: 'report',\n            title: 'Отчет',\n            method: errorReport,\n            parameters: error,\n            closeAfter: true\n        }\n    };\n    createNotification(\n        title ? title : 'Произошла ошибка!',\n        message ? message : error.message,\n        icon ? icon : pms.config.icon,\n        false, actions);\n    return true;\n}\n\nfunction errorReport(error) {\n    error = {\n        message: error.message,\n        stack: error.stack,\n        hostId: pms.selectedHost.id\n    };\n    return io('console/errorHandler', error).then(function (response) {\n        return response.status;\n    });\n}\n\nexport function initPromise(result) {\n    return new Promise(function (resolve, reject) {\n        return resolve(result);\n    });\n}\n\n\n// WEBPACK FOOTER //\n// ./assets/js/workspace.js","import * as workspace from './workspace.js';\nimport * as auth from './auth.js';\n\nwindow.pms = {\n    config: {\n        apiUrl: 'https://cms.prakula.ru/api/v1/',\n        name: 'PRakula CMS',\n        icon: '/pms-console/assets/images/logo.small.png'\n    }\n};\nwindow.io = io;\nwindow.oldIo = oldIo;\nwindow.initApp = initApp;\n// require('../css/style.css');\n\nwindow.addEventListener('load', function () {\n    pms.config.isFramed = false;\n    try {\n        pms.config.isFramed = window != window.top || document != top.document || self.location != top.location;\n    } catch (e) {\n        pms.config.isFramed = true;\n    }\n    if (pms.config.isFramed) {\n        window.addEventListener('message', function (event) {\n            if (window.initTimeout) clearTimeout(window.initTimeout);\n            delete window.initTimeout;\n            if (typeof event.data === 'object') window.pmsHostData = event.data;\n            initApp();\n        });\n        window.initTimeout = setTimeout(function () {\n            initApp();\n        }, 1000);\n        window.parent.postMessage({status: true, get: 'pmsHostData'}, '*');\n    } else initApp();\n});\n\nfunction initApp() {\n    if (window.pmsHostData) pms.currentHost = window.pmsHostData;\n    // console.debug(pms);\n    return auth.check().then(function (response) {\n        if (response) {\n            return workspace.prepare();\n        } else {\n            return auth.showLogin();\n        }\n    });\n}\n\nfunction oldIo(method, data, post, url, plainData) {\n    url = url ? url : (pms.config.apiUrl ? pms.config.apiUrl : '/api/') + method;\n    if (!post) {\n        data = data ? data : '';\n        if (typeof data === 'object') data = Object.keys(data).map(function (k) {\n            return encodeURIComponent(k) + '=' + encodeURIComponent(data[k]);\n        }).join('&');\n    }\n    if (method) {\n        let token = localStorage.getItem('token') ?\n            localStorage.getItem('token') : false;\n        /*(pms.currentHost ?\n            (pms.currentHost.token ? pms.currentHost.token : false) :\n            false);*/\n        if (token) {\n            if (post) data['_token'] = token; else data += (data !== '' ? '&' : '') + '_token=' + token;\n        }\n    }\n    if (data !== '' && !post) url += '?' + data;\n    let parameters = {\n        method: (post ? 'POST' : 'GET'),\n        mode: 'cors',\n        credentials: 'include'\n    };\n    if (post) parameters.body = JSON.stringify(data);\n    return fetch(url, parameters).then(function (response) {\n        if (response.status >= 200 && response.status < 300) {\n            return response\n        } else {\n            return plainData ? false : {'status': false, 'error': response.statusText};\n        }\n    }).then(function (response) {\n        if (!response) return response;\n        if (plainData) return response.text(); else return response.json();\n    }).catch(function (response) {\n        let debugData = ['Response parse error'];\n        if (response.message) debugData.push(response.message);\n        if (method) debugData.push(method);\n        if (data !== '') debugData.push(method ? decodeURIComponent(data) : decodeURIComponent(url));\n        console.debug.apply(this, debugData);\n        return {'status': false, 'error': 'Response parse error'};\n    }).then(function (response) {\n        if (!response || response.error) return response;\n        let debugData = [response.offline ? 'Offline mode' : 'Request successful'];\n        if (method) debugData.push(method);\n        if (data !== '') debugData.push(method ? decodeURIComponent(data) : decodeURIComponent(url));\n        debugData.push(response);\n        console.debug.apply(this, debugData);\n        if (response.offline) initOfflineMode(); else pms.offline = false;\n        return response;\n    }).catch(function (error) {\n        console.error(error);\n        return {'status': false};\n    });\n}\n\nfunction io(method, getData, postData, url, plainData) {\n    url = url ? url : (pms.config.apiUrl ? pms.config.apiUrl : '/api/') + method;\n    getData = getData ? getData : '';\n    if (typeof getData === 'object') getData = serialize(getData);\n    postData = postData ? postData : false;\n    if (typeof postData === 'object') postData = serialize(postData);\n    if (method && !getCookie('token')) {\n        let token = localStorage.getItem('token');\n        if (token) {\n            getData += (getData !== '' ? '&' : '') + '_token=' + token;\n        }\n    }\n    if (getData !== '') url += '?' + getData;\n    let parameters = {\n        method: (postData ? 'POST' : 'GET'),\n        mode: 'cors',\n        credentials: 'include'\n    };\n    if (postData) parameters.body = postData;\n    return fetch(url, parameters).then(function (response) {\n        if (response.status >= 200 && response.status < 300) {\n            return response\n        } else {\n            return plainData ? false : {'status': false, 'error': response.statusText};\n        }\n    }).then(function (response) {\n        if (!response) return response;\n        if (plainData) return response.text(); else return response.json();\n    }).catch(function (response) {\n        let debugData = ['Response parse error'];\n        if (response.message) debugData.push(response.message);\n        if (method) debugData.push(method);\n        if (getData !== '') debugData.push(method ? decodeURIComponent(getData) : decodeURIComponent(url));\n        if (postData && method) debugData.push(decodeURIComponent(postData));\n        console.debug.apply(this, debugData);\n        return {'status': false, 'error': 'Response parse error'};\n    }).then(function (response) {\n        if (!response || response.error) return response;\n        let debugData = [response.offline ? 'Offline mode' : 'Request successful'];\n        if (method) debugData.push(method);\n        if (getData !== '') debugData.push(method ? decodeURIComponent(getData) : decodeURIComponent(url));\n        if (postData && method) debugData.push(decodeURIComponent(postData));\n        debugData.push(response);\n        console.debug.apply(this, debugData);\n        if (response.offline) initOfflineMode(); else pms.offline = false;\n        return response;\n    }).catch(function (error) {\n        console.error(error);\n        return {'status': false};\n    });\n}\n\nfunction serialize (obj, prefix) {\n    var str = [], p;\n    for(p in obj) {\n        if (obj.hasOwnProperty(p)) {\n            var k = prefix ? prefix + \"[\" + p + \"]\" : p, v = obj[p];\n            str.push((v !== null && typeof v === \"object\") ?\n                serialize(v, k) :\n                encodeURIComponent(k) + \"=\" + encodeURIComponent(v));\n        }\n    }\n    return str.join(\"&\");\n}\n\nfunction getCookie(name) {\n    let matches = document.cookie.match(new RegExp(\n        \"(?:^|; )\" + name.replace(/([\\.$?*|{}\\(\\)\\[\\]\\\\\\/\\+^])/g, '\\\\$1') + \"=([^;]*)\"\n    ));\n    return matches ? decodeURIComponent(matches[1]) : undefined;\n}\n\nfunction initOfflineMode() {\n    if (pms.offline === true) return true;\n    pms.offline = true;\n    alert('Мы потеряли соединение с сервером, проверьте подключение и повторите');\n    return true\n}\n\n\n// WEBPACK FOOTER //\n// ./assets/js/init.js","import * as workspace from './workspace.js';\n\nlet template = {};\n\nwindow.auth = {logout: logout};\n\nexport function check() {\n    return io('console/getUserData').then(function (response) {\n        if (response.status) saveUserData(response);\n        return response.status;\n    });\n}\n\nexport function send(login, password) {\n    // auth.loginSection.classList.toggle('incorrect-data', false);\n    return new Promise(function (resolve, reject) {\n        if (!login || login === '') return resolve(loginError('empty_login', 'login'));\n        if (!login || password === '') return resolve(loginError('empty_password', 'password'));\n        showItemLoadIndicator('auth', 'login-button');\n        let data = {login: login, password: password};\n        return resolve(io('console/auth', data));\n    });\n}\n\n\nfunction loginError(message, type) {\n    // return new Promise(function (resolve, reject) {\n    let authLogin = document.getElementById('auth-login');\n    let loginMessage = document.getElementById('auth-login-message');\n    let authPassword = document.getElementById('auth-password');\n    let passwordMessage = document.getElementById('auth-password-message');\n    if (type) switch (type) {\n        case 'login':\n            switch (message) {\n                case 'empty_login':\n                    loginMessage.innerText = 'Необходимо ввести ваш логин';\n                    break;\n            }\n            authLogin.classList.toggle('highlight', true);\n            break;\n        case 'password':\n            switch (message) {\n                case 'empty_password':\n                    passwordMessage.innerText = 'Необходимо ввести ваш пароль';\n                    break;\n                case 'incorrect_data':\n                    passwordMessage.innerText = 'Указан неверный пароль';\n                    break;\n            }\n            authPassword.classList.toggle('highlight', true);\n            break;\n        case 'all':\n            switch (message) {\n                case 'bad_parameters':\n                    loginMessage.innerText = 'Необходимо ввести ваш логин';\n                    passwordMessage.innerText = 'Необходимо ввести ваш пароль';\n                    break;\n            }\n            authLogin.classList.toggle('highlight', true);\n            authPassword.classList.toggle('highlight', true);\n\n    }\n    hideItemLoadIndicator('auth', 'login-button');\n    setProgress('auth-button', false);\n    auth.loginSection.classList.toggle('incorrect-data', true);\n    setTimeout(function () {\n        auth.loginSection.classList.toggle('incorrect-data', false);\n    }, 500);\n    console.log(message ? message : type);\n    return false;// resolve(false);\n    // });\n}\n\nexport function showLogin() {\n    if (!template.login) return workspace.loadTemplate('login')\n        .then(function (response) {\n            if (!response) return 'Не удалось загрузить страницу';\n            return template.login = response;\n        }).then(workspace.render).then(prepareLogin); else\n        return workspace.render(template.login)\n            .then(prepareLogin);\n}\n\nfunction prepareLogin() {\n    if (pms.currentHost) {\n        if (pms.currentHost.title && document.getElementById('host-name')) document.getElementById('host-name').innerText = pms.currentHost.title;\n        if (pms.currentHost.logo && document.getElementById('host-logo')) document.getElementById('host-logo').src = pms.currentHost.logo;\n        if (pms.currentHost.homePage && document.getElementById('home-page')) document.getElementById('home-page').href = pms.currentHost.homePage;\n    }\n    if (document.getElementById('login-section')) auth.loginSection = document.getElementById('login-section');\n    if (document.getElementById('auth-button')) document.getElementById('auth-button').addEventListener('click', function () {\n        if (isProgress('auth-button')) return false;\n        if (!document.getElementById('auth-login') || !document.getElementById('auth-password')) return false;\n        document.getElementById('auth-login').classList.toggle('highlight', false);\n        document.getElementById('auth-login-message').innerText = '';\n        document.getElementById('auth-password').classList.toggle('highlight', false);\n        document.getElementById('auth-password-message').innerText = '';\n        setProgress('auth-button');\n        showLoadingIndicator();\n        return send(document.getElementById('auth-login').value, document.getElementById('auth-password').value).then(function (response) {\n            if (!response) return false;\n            if (!response.status) return loginError('incorrect_data', 'password');\n            if (response.token) {\n                localStorage.setItem('token', response.token);\n                /*if (pms.config.isFramed) window.parent.postMessage({\n                    status: true,\n                    set: 'token',\n                    data: response.token\n                }, '*');*/\n            }\n            pms.onLeavePage.push(function () {\n                hideItemLoadIndicator('auth', 'login-button');\n            });\n            saveUserData(response);\n            return workspace.prepare();\n        }).then(hideLoadingIndicator).then(function () {\n            return setProgress('auth-button', false);\n        });\n    });\n    return true;\n}\n\nfunction saveUserData(response) {\n    if (!response || !response.status) return false;\n    pms.userData = {};\n    if (response.userId) pms.userData.id = response.userId;\n    if (response.login) pms.userData.login = response.login;\n    if (response.email) pms.userData.email = response.email;\n    if (response.firstname) pms.userData.firstname = response.firstname;\n    if (response.lastname) pms.userData.lastname = response.lastname;\n    if (response.avamoji) pms.userData.avamoji = response.avamoji;\n\n    let OneSignal = window.OneSignal || [];\n    OneSignal.push([\"init\", {\n        appId: \"d6d3da7e-593f-4b75-a598-a5d4b27e31e6\",\n        autoRegister: true,\n        notifyButton: {\n            enable: false,\n        },\n        promptOptions: {\n            actionMessage: \"Уведомим о важных событиях связанных с сайтом, продвижением страниц и других изменениях\",\n            acceptButtonText: \"Получать\",\n            cancelButtonText: \"Отказаться\"\n        }\n    }]);\n    return true;\n}\n\nfunction logout() {\n    return io('console/logout').then(function (response) {\n        if (response && response.status) {\n            window.pms = {\n                config: pms.config\n            };\n            localStorage.clear();\n            return showLogin();\n        } else alert('Произошла ошибка');\n    })\n}\n\n\n// WEBPACK FOOTER //\n// ./assets/js/auth.js"],"sourceRoot":""}