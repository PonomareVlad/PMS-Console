{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./assets/js/workspace.js","webpack:///./assets/js/init.js","webpack:///./assets/js/auth.js"],"names":["installedModules","__webpack_require__","moduleId","exports","module","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","init","prepare","loadTemplate","render","updateHostsData","renderHostsSelectMenu","loadHost","getHostModules","getModuleData","loadModule","loadMenu","menuItemClick","showItemLoadIndicator","hideItemLoadIndicator","showLoadingIndicator","hideLoadingIndicator","leavePage","selectHost","isProgress","setProgress","renderMenuItems","getHostUrl","loadNotifications","renderNotifications","notifyAction","removeNotification","createNotification","showNotification","errorHandler","initPromise","template","pms","workspace","onLeavePage","appearance","loadIndicators","progressState","window","addEventListener","onFirstTouch","document","body","classList","toggle","removeEventListener","test","navigator","userAgent","MSStream","iOS","standalone","toLowerCase","indexOf","macOs","require","script","io","then","response","eval","apply","e","console","error","wrapper","alert","prepareWrapper","selectedHost","title","getElementById","innerText","logo","src","homePage","href","currentHost","this","toggleMobileMenu","userName","userData","firstname","lastname","login","avamoji","menu","notificationsWrapper","id","html","node","arguments","length","undefined","Promise","resolve","reject","innerHTML","status","hostsData","domainsHost","domain","outputSource","hostsDataKeys","keys","host","menuNode","parentNode","style","display","hostId","menuStructure","modulesData","moduleData","push","loaded","menuSource","menu_item_title","description","itemId","parameters","type","workspaceGenerator","catch","result","menuItemsWorker","menuItems","menu_item_type","_typeof","debug","statusText","attribute","item","querySelectorAll","loader","querySelector","setTimeout","recursion","removeChild","cursor","state","menuId","items","container","JSON","stringify","excludePath","hostData","https","path","notifications","notification","notificationsSource","icon","time","actions","action","notificationId","actionId","method","closeAfter","local","parseInt","splice","data","Date","getTime","notificationSource","message","close","report","errorReport","config","stack","onerror","url","lineNumber","auth","initApp","pmsHostData","check","showLogin","serialize","obj","prefix","str","k","v","encodeURIComponent","join","initOfflineMode","offline","apiUrl","getData","postData","plainData","matches","cookie","match","RegExp","replace","decodeURIComponent","getCookie","token","localStorage","getItem","credentials","fetch","text","json","debugData","oldIo","post","map","isFramed","top","self","location","event","initTimeout","clearTimeout","parent","postMessage","saveUserData","send","password","loginError","authLogin","loginMessage","authPassword","passwordMessage","loginSection","log","prepareLogin","setItem","userId","email","OneSignal","appId","autoRegister","notifyButton","enable","promptOptions","actionMessage","acceptButtonText","cancelButtonText","logout","clear"],"mappings":"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","file":"init.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"/pms-console/\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 1);\n","let template = {};\n\nwindow.menuItemClick = menuItemClick;\nwindow.workspace = {render: render, loadTemplate: loadTemplate, require: require, leavePage: leavePage, init: init};\nwindow.showLoadingIndicator = showLoadingIndicator;\nwindow.hideLoadingIndicator = hideLoadingIndicator;\nwindow.showItemLoadIndicator = showItemLoadIndicator;\nwindow.hideItemLoadIndicator = hideItemLoadIndicator;\nwindow.selectHost = selectHost;\nwindow.isProgress = isProgress;\nwindow.setProgress = setProgress;\nwindow.getHostUrl = getHostUrl;\nwindow.notifyAction = notifyAction;\nwindow.createNotification = createNotification;\nwindow.showNotification = showNotification;\nwindow.errorHandler = errorHandler;\nwindow.initPromise = initPromise;\n\nwindow.onerror = function (message, url, lineNumber) {\n    return errorHandler(arguments, message);\n    /*alert(\"Поймана ошибка, выпавшая в глобальную область!\\n\" +\n        \"Сообщение: \" + message + \"\\n(\" + url + \":\" + lineNumber + \")\");*/\n};\n\nexport function init() {\n    if (!pms.workspace) pms.workspace = {};\n    if (!pms.onLeavePage) pms.onLeavePage = [];\n    if (!pms.appearance) pms.appearance = {};\n    if (!pms.appearance.loadIndicators) pms.appearance.loadIndicators = {};\n    if (!pms.progressState) pms.progressState = {};\n\n    window.addEventListener('touchstart', function onFirstTouch() {\n        document.body.classList.toggle('touchscreen', true);\n        window.removeEventListener('touchstart', onFirstTouch, false);\n    }, false);\n\n    if (/iPad|iPhone|iPod/.test(navigator.userAgent) && !window.MSStream) {\n        pms.workspace.iOS = true;\n        if ((\"standalone\" in window.navigator) && window.navigator.standalone) document.body.classList.toggle('ios-standalone', true);\n    } else if (navigator.userAgent.toLowerCase().indexOf('safari') !== -1 && navigator.userAgent.toLowerCase().indexOf('chrome') < 0) {\n        pms.workspace.macOs = true;\n    } else {\n        document.body.classList.toggle('material', true);\n    }\n}\n\nexport function require(script) {\n    return io(false, false, false, './assets/js/' + script + '.js', true)\n        .then(function (response) {\n            if (!response) return false;\n            try {\n                eval.apply(window, [response]);\n            } catch (e) {\n                console.error(e);\n                return false;\n            }\n            return true;\n        })\n}\n\nexport function prepare() {\n    init();\n    showLoadingIndicator();\n    if (!template.wrapper) return loadTemplate('wrapper')\n        .then(function (response) {\n            if (!response) {\n                alert('Не удалось загрузить страницу');\n                return false;\n            }\n            return template.wrapper = response;\n        })\n        // .then(prepareWrapper)\n        .then(updateHostsData).then(function () {\n            return render(template.wrapper);\n        })\n        .then(loadHost)\n        .then(renderHostsSelectMenu).then(loadNotifications)\n        .then(hideLoadingIndicator);\n    else\n        return updateHostsData().then(function () {\n            return render(template.wrapper);\n        })\n            .then(loadHost)\n            .then(renderHostsSelectMenu).then(loadNotifications)\n            .then(hideLoadingIndicator);\n}\n\nfunction prepareWrapper() {\n    if (pms.selectedHost) {\n        if (pms.selectedHost.title && document.getElementById('host-name'))\n            document.getElementById('host-name').innerText = pms.selectedHost.title;\n        if (pms.selectedHost.logo && document.getElementById('host-logo'))\n            document.getElementById('host-logo').src = pms.selectedHost.logo;\n        if (pms.selectedHost.homePage && document.getElementById('home-page'))\n            document.getElementById('home-page').href = pms.selectedHost.homePage;\n    } else if (pms.currentHost) {\n        if (pms.currentHost.title && document.getElementById('host-name'))\n            document.getElementById('host-name').innerText = pms.currentHost.title;\n        if (pms.currentHost.logo && document.getElementById('host-logo'))\n            document.getElementById('host-logo').src = pms.currentHost.logo;\n        if (pms.currentHost.homePage && document.getElementById('home-page'))\n            document.getElementById('home-page').href = pms.currentHost.homePage;\n    }\n    if (document.getElementById('select-hosts-menu')) document.getElementById('select-hosts-menu').addEventListener('change', function () {\n        selectHost(this.value);\n    });\n    if (document.getElementById('header-menu-button')) document.getElementById('header-menu-button').addEventListener('click', toggleMobileMenu);\n    let userName = pms.userData.firstname ? pms.userData.firstname + (pms.userData.lastname ? ' ' + pms.userData.lastname : '') : (pms.userData.login ? pms.userData.login : 'Любимый пользователь');\n    if (document.getElementById('user-name')) document.getElementById('user-name').innerText = userName;\n    if (pms.userData.avamoji && document.getElementById('user-avamoji')) document.getElementById('user-avamoji').innerText = pms.userData.avamoji;\n    if (document.getElementById('workspace-menu'))\n        pms.workspace.menu = document.getElementById('workspace-menu');\n    if (document.getElementById('workspace-wrapper'))\n        pms.workspace.wrapper = document.getElementById('workspace-wrapper');\n    if (document.getElementById('notificationsWrapper')) {\n        pms.workspace.notificationsWrapper = document.getElementById('notificationsWrapper');\n    }\n    return true;\n}\n\nexport function loadTemplate(id) {\n    return io(false, false, false, './' + id + '.html', true)\n        .then(function (response) {\n            if (typeof response !== 'string') return false;\n            else return response;\n        });\n}\n\nexport function render(html, node = document.body) {\n    init();\n    leavePage(); /// FUUUCK!!!!\n    return new Promise(function (resolve, reject) {\n        if (!html) return false;\n        node.innerHTML = html;\n        return resolve(node);\n    });\n}\n\nexport function updateHostsData() {\n    return io('console/getHosts').then(function (response) {\n        if (!response.status) return false;\n        if (response.hostsData) {\n            if (!pms.hostsData) pms.hostsData = {};\n            if (!pms.domainsHost) pms.domainsHost = {};\n            for (let i in response.hostsData) {\n                pms.hostsData[response.hostsData[i].id] = response.hostsData[i];\n                pms.domainsHost[response.hostsData[i].domain] = response.hostsData[i];\n            }\n        }\n        return true;\n    })\n}\n\nexport function renderHostsSelectMenu() {\n    let outputSource = '<option selected disabled>🌐 Выбрать Сайт</option>';\n    let hostsDataKeys = Object.keys(pms.hostsData);\n    for (let i in hostsDataKeys) {\n        let host = pms.hostsData[hostsDataKeys[i]];\n        let title = host.title ? host.title : host.domain;\n        //let active = pms.selectedHost ? (pms.selectedHost.id === host.id ? 'selected' : '') : '';\n        outputSource += '<option value=\"' + host.id + '\" ' + '>' + title + '</option>';\n    }\n    let menuNode = document.getElementById('select-hosts-menu');\n    menuNode.innerHTML = outputSource;\n    if (hostsDataKeys.length > 1) menuNode.parentNode.style.display = 'initial';\n    else menuNode.parentNode.style.display = 'none';\n    return true;\n}\n\nexport function loadHost(id) {\n    leavePage();\n    return new Promise(function (resolve, reject) {\n        if (!pms.hostsData) return resolve(false);\n        if (!id || !(typeof id === \"string\" || typeof id === \"number\")) {\n            id = false;\n            if (pms.currentHost && pms.currentHost.domain)\n                if (pms.domainsHost[pms.currentHost.domain]) id = pms.domainsHost[pms.currentHost.domain].id;\n            id = id ? id : Object.keys(pms.hostsData)[0];\n        }\n        let host = pms.selectedHost = pms.hostsData[id];\n        if (!host.modules) return resolve(getHostModules(host.id).then(function (response) {\n            if (!response) return response;\n            return host;\n        }).then(prepareWrapper).then(loadMenu));\n        return resolve(new Promise(function (resolve, reject) {\n            return resolve(prepareWrapper());\n        }).then(loadMenu));\n    });\n}\n\nexport function getHostModules(hostId) {\n    return io('console/getModules', {hostId: hostId}).then(function (response) {\n        if (!response.status) return false;\n        let host = pms.hostsData[hostId];\n        host.menuStructure = [];\n        if (!host.modules) host.modules = {};\n        for (let i in response.modulesData) {\n            let moduleData = response.modulesData[i];\n            if (!pms.module) pms.module = {};\n            if (!pms.module[moduleData.id]) pms.module[moduleData.id] = moduleData;\n            host.modules[moduleData.id] = pms.module[moduleData.id];\n            host.menuStructure.push(host.modules[moduleData.id]);\n        }\n        return true;\n    })\n}\n\nexport function getModuleData(moduleId, hostId = false) {\n    hostId = hostId ? hostId : pms.selectedHost.id;\n    // console.debug('getModuleData', moduleId, hostId);\n    return new Promise(function (resolve, reject) {\n        if (pms.hostsData[hostId].modules[moduleId].init) return resolve(moduleId);\n        else return resolve(io('console/getModuleData', {\n            moduleId: moduleId,\n            hostId: hostId\n        }).then(function (response) {\n            if (!response.status || !response.init) return false;\n            let host = pms.hostsData[hostId];\n            host.modules[moduleId].init = response.init;\n            return moduleId;\n        }));\n    });\n}\n\nexport function loadModule(moduleId) {\n    return new Promise(function (resolve, reject) {\n        if (!pms.module[moduleId] || !pms.module[moduleId].init) return resolve(false);\n        if (pms.module[moduleId].loaded) return resolve(true);\n        try {\n            eval(pms.module[moduleId].init);\n        } catch (e) {\n            reject(e);\n        }\n        pms.module[moduleId].loaded = true;\n        return resolve(true);\n    });\n}\n\nexport function loadMenu() {\n    if (!pms.selectedHost || !pms.selectedHost.modules) return false;\n    let modules = pms.selectedHost.menuStructure ? pms.selectedHost.menuStructure : pms.selectedHost.modules;\n    let menuSource = '<h2>Меню:</h2><ul>';\n    for (let i in modules) {\n        let module = pms.module[modules[i].id];\n        let title = module.menu_item_title ? module.menu_item_title : (module.title ? module.title : module.id);\n        let description = module.description ? ('<p>' + module.description + '</p>') : '';\n        menuSource += '<li data-menu-item=\"' + module.id + '\" onclick=\"menuItemClick(\\'' + module.id + '\\')\"><a href=\"javascript:void(0);\"><span>' + title + '</span>' + description + '</a>' + '</li><ul data-menu-item-container=\"' + module.id + '\"></ul>';\n    }\n    menuSource += '</ul>';\n    if (pms.workspace.menu) pms.workspace.menu.innerHTML = menuSource;\n    return true;\n}\n\nexport function menuItemClick(moduleId = false, itemId = false, parameters = false, type = false) {\n    if (isProgress('menuItem')) return false;\n    setProgress('menuItem');\n    let module = pms.module[moduleId];\n    if (!itemId) itemId = moduleId;\n    showItemLoadIndicator(itemId, 'menu-item');\n    showLoadingIndicator();\n    if (!parameters) {\n        if (module.menu_item_type && module.menu_item_type === 'item') {\n            if (!module.loaded) getModuleData(moduleId).then(loadModule).catch(function (error) {\n                return false;\n            }).then(function (response) {\n                if (!response || !module.loaded) alert('Раздел временно недоступен');\n                if (module.workspaceGenerator) return module.workspaceGenerator();\n                return {status: true};\n            }).then(function (response) {\n                if (typeof response !== 'object') return false;\n                if (!response.status) console.debug(moduleId, response.statusText ? response.statusText : response);\n                return true;\n            }).then(function (result) {\n                setProgress('menuItem', false);\n                hideLoadingIndicator();\n                hideItemLoadIndicator(itemId, 'menu-item');\n                toggleMobileMenu(false);\n                return result;\n            });\n            else if (module.workspaceGenerator)\n                return module.workspaceGenerator()\n                    .then(function (result) {\n                        setProgress('menuItem', false);\n                        hideLoadingIndicator();\n                        hideItemLoadIndicator(itemId, 'menu-item');\n                        toggleMobileMenu(false);\n                        return result;\n                    });\n        } else if (module.menu_item_type && module.menu_item_type === 'group') {\n            if (!module.loaded) getModuleData(moduleId).then(loadModule).catch(function (error) {\n                return false;\n            }).then(function (response) {\n                if (!response || !module.loaded) alert('Раздел временно недоступен');\n                if (module.menuItemsWorker) return module.menuItemsWorker();\n                return {status: true};\n            }).then(function (response) {\n                // console.debug(response);\n                if (typeof response !== 'object') return false;\n                if (!response.status) console.debug(moduleId, response.statusText ? response.statusText : response);\n                return response.menuItems ? renderMenuItems(moduleId, itemId, response.menuItems) : true;\n            }).then(function (result) {\n                setProgress('menuItem', false);\n                hideLoadingIndicator();\n                hideItemLoadIndicator(itemId, 'menu-item');\n                return result;\n            });\n            else if (module.menuItemsWorker)\n                return module.menuItemsWorker().then(function (response) {\n                    console.debug(response);\n                    if (typeof response !== 'object') return false;\n                    if (!response.status) console.debug(moduleId, response.statusText ? response.statusText : response);\n                    return response.menuItems ? renderMenuItems(moduleId, itemId, response.menuItems) : true;\n                }).then(function (result) {\n                    setProgress('menuItem', false);\n                    hideLoadingIndicator();\n                    hideItemLoadIndicator(itemId, 'menu-item');\n                    return result;\n                });\n            setProgress('menuItem', false);\n            hideLoadingIndicator();\n            hideItemLoadIndicator(itemId, 'menu-item');\n        }\n    } else {\n        if (!type) {\n\n        } else {\n            // console.debug(moduleId, parameters, type);\n            if (type === 'item') {\n                if (module.workspaceGenerator)\n                    return module.workspaceGenerator(parameters)\n                        .catch(errorHandler)\n                        .then(function (result) {\n                            setProgress('menuItem', false);\n                            hideLoadingIndicator();\n                            hideItemLoadIndicator(itemId, 'menu-item');\n                            toggleMobileMenu(false);\n                            return result;\n                        });\n            } else if (type === 'group') {\n                if (module.menuItemsWorker)\n                    return module.menuItemsWorker(parameters)\n                        .catch(errorHandler)\n                        .then(function (response) {\n                            // console.debug('menuItemClick (ItemsWorker)', response);\n                            setProgress('menuItem', false);\n                            hideLoadingIndicator();\n                            hideItemLoadIndicator(itemId, 'menu-item');\n                            return response.menuItems ? renderMenuItems(moduleId, itemId, response.menuItems) : true;\n                        });\n            }\n        }\n    }\n}\n\nexport function showItemLoadIndicator(id, attribute) {\n    if (!pms.appearance) pms.appearance = {};\n    if (!pms.appearance.loadIndicators) pms.appearance.loadIndicators = {};\n    let item = document.querySelectorAll('[data-' + attribute + '=\"' + id + '\"]');\n    if (!item || item.length === 0) return false;\n    if (pms.appearance.loadIndicators[attribute + '-' + id]) return false; //else console.debug('showItemLoadIndicator', 'indicator for ' + attribute + '-' + id + ' already active', pms.appearance.loadIndicators[attribute + '-' + id], pms.appearance);\n    pms.appearance.loadIndicators[attribute + '-' + id] = 'initShow';\n    item = item[0];\n    let loader = item.querySelector('.loader-spinner-wrapper');\n    if (!loader || loader.length === 0) {\n        item.innerHTML += `<div class=\"loader-spinner-wrapper\">\n<div class=\"ispinner ispinner--gray ispinner--animating\">\n  <div class=\"ispinner__blade\"></div>\n  <div class=\"ispinner__blade\"></div>\n  <div class=\"ispinner__blade\"></div>\n  <div class=\"ispinner__blade\"></div>\n  <div class=\"ispinner__blade\"></div>\n  <div class=\"ispinner__blade\"></div>\n  <div class=\"ispinner__blade\"></div>\n  <div class=\"ispinner__blade\"></div>\n  <div class=\"ispinner__blade\"></div>\n  <div class=\"ispinner__blade\"></div>\n  <div class=\"ispinner__blade\"></div>\n  <div class=\"ispinner__blade\"></div>\n</div></div>`\n    }\n    setTimeout(function () {\n        item.classList.toggle('loader-spinner-active', true);\n        pms.appearance.loadIndicators[attribute + '-' + id] = 'show';\n    }, 100);\n}\n\nexport function hideItemLoadIndicator(id, attribute, recursion) {\n    if (pms.appearance.loadIndicators[attribute + '-' + id] && pms.appearance.loadIndicators[attribute + '-' + id] === 'initShow') {\n        if (!recursion) setTimeout(function () {\n            hideItemLoadIndicator(id, attribute, true)\n        }, 100);\n        return false;\n    }\n    pms.appearance.loadIndicators[attribute + '-' + id] = 'initHide';\n    let item = document.querySelector('[data-' + attribute + '=\"' + id + '\"]');\n    if (!item || item.length === 0) {\n        pms.appearance.loadIndicators[attribute + '-' + id] = false;\n        delete pms.appearance.loadIndicators[attribute + '-' + id];\n        return false;\n    }\n    item.classList.toggle('loader-spinner-active', false);\n    setTimeout(function () {\n        let item = document.querySelector('[data-' + attribute + '=\"' + id + '\"]');\n        if (!item || item.length === 0) {\n            pms.appearance.loadIndicators[attribute + '-' + id] = false;\n            delete pms.appearance.loadIndicators[attribute + '-' + id];\n            return false;\n        }\n        let loader = item.querySelector('.loader-spinner-wrapper');\n        if (loader && loader.length > 0) {\n            loader[0].parentNode.removeChild(loader[0]);\n        }\n        pms.appearance.loadIndicators[attribute + '-' + id] = false;\n        delete pms.appearance.loadIndicators[attribute + '-' + id];\n    }, 500);\n}\n\nexport function showLoadingIndicator(result = true) {\n    document.body.style.cursor = 'progress';\n    return result;\n}\n\nexport function hideLoadingIndicator(result = true) {\n    document.body.style.cursor = 'default';\n    return result;\n}\n\nexport function leavePage() {\n    return new Promise(function (resolve, reject) {\n        if (!pms.onLeavePage) pms.onLeavePage = [];\n        for (let i in pms.onLeavePage) if (typeof pms.onLeavePage[i] === \"function\") try {\n            pms.onLeavePage[i]();\n        } catch (e) {\n            console.error(e);\n        }\n        pms.onLeavePage = [];\n        resolve(true);\n    });\n}\n\nexport function selectHost(id) {\n    return render(template.wrapper)\n    // .then(prepareWrapper)\n        .then(function () {\n            return loadHost(id);\n        }).then(renderHostsSelectMenu)\n        .then(hideLoadingIndicator);\n}\n\nexport function isProgress(id) {\n    return pms.progressState[id];\n}\n\nexport function setProgress(id, state = true) {\n    pms.progressState[id] = state;\n    if (!state) delete pms.progressState[id];\n    return true;\n}\n\nexport function renderMenuItems(moduleId, menuId, items) {\n    let container = document.querySelectorAll('[data-menu-item-container=\"' + menuId + '\"]');\n    if (!container || container.length === 0) return false;\n    let menuSource = '';\n    for (let i in items) {\n        let item = items[i];\n        let title = item.menu_item_title ? item.menu_item_title : (item.title ? item.title : item.id);\n        let description = item.description ? ('<p>' + item.description + '</p>') : '';\n        let parameters = item.parameters ? item.parameters : {};\n        if (!item['type']) item['type'] = 'item';\n        parameters['id'] = item.id;\n        menuSource += '<li data-menu-item=\"' + item.id + '\" onclick=\\'menuItemClick(\"' + moduleId + '\",\"' + item.id + '\",' + JSON.stringify(parameters) + ',\"' + item.type + '\")\\'><a href=\"javascript:void(0);\"><span>' + title + '</span>' + description + '</a>' + '</li><ul data-menu-item-container=\"' + item.id + '\"></ul>';\n    }\n    if (container[0]) container[0].innerHTML = menuSource;\n    return true;\n}\n\nexport function getHostUrl(excludePath, hostId) {\n    if (!hostId) hostId = pms.selectedHost.id;\n    let hostData = pms.hostsData[hostId];\n    return (hostData.https ? 'https://' : 'http://') + hostData.domain + (!excludePath && hostData.path ? hostData.path + '/' : '');\n}\n\nexport function loadNotifications(result) {\n    if (!pms.userData.notifications) pms.userData.notifications = [];\n    io('console/getUserNotifications').then(function (response) {\n        if (!response.status || !response.notifications) return false;\n        pms.notifications = response.notifications;\n        if (!pms.notification) pms.notification = {};\n        for (let i in pms.notifications) if (pms.notifications[i].id) pms.notification[pms.notifications[i].id] = pms.notifications[i];\n        return true;\n    }).then(renderNotifications);\n    return result;\n}\n\nexport function renderNotifications() {\n    if (!pms.workspace.notificationsWrapper) return false;\n    if (!pms.notifications || pms.notifications.length === 0) return true;\n    let notificationsSource = '';\n    for (let i in pms.notifications) {\n        let notification = pms.notifications[i];\n        if (!notification.id) continue;\n        notificationsSource += '<div class=\"notification background-blur\" data-notification=\"' + notification.id + '\"><div class=\"notification-data\"><div class=\"notification-header\"><div class=\"notification-header-side\">';\n        if (notification.icon) notificationsSource += '<figure style=\"background-image: url(' + notification.icon + ')\"></figure>';\n        if (notification.title) notificationsSource += '<span>' + notification.title + '</span>';\n        notificationsSource += '</div>';\n        if (notification.time) notificationsSource += '<div class=\"notification-header-side\"><span>' + notification.time + '</span></div>';\n        notificationsSource += '</div>';\n        if (notification.body) notificationsSource += '<div class=\"notification-body\">' + notification.body + '</div>';\n        notificationsSource += '</div><div class=\"notification-control\">';\n        if (notification.actions) {\n            for (let i in notification.actions) {\n                let action = notification.actions[i];\n                notificationsSource += '<button class=\"notification-control-item\" data-notification-action=\"' + notification.id + '_' + action.id + '\" onclick=\"notifyAction(\\'' + notification.id + '\\',\\'' + action.id + '\\');\">' + action.title + '</button>';\n            }\n        } else notificationsSource += '<button class=\"notification-control-item\" data-notification-action=\"' + notification.id + '_close\" onclick=\"notifyAction(\\'' + notification.id + '\\',\\'close\\');\">Закрыть</button>';\n        notificationsSource += '</div></div>';\n    }\n    pms.workspace.notificationsWrapper.innerHTML = notificationsSource;\n    return true;\n}\n\nexport function notifyAction(notificationId, actionId) {\n    if (!notificationId || !pms.notification[notificationId]) return false;\n    if (isProgress('notification_' + notificationId)) return false;\n    setProgress('notification_' + notificationId);\n    let notification = pms.notification[notificationId];\n    if (!actionId || actionId === 'close') {\n        if (notification.local) {\n            setProgress('notification_' + notificationId, false);\n            return removeNotification(notification.id);\n        }\n        showItemLoadIndicator(notificationId + '_' + actionId, 'notification-action');\n        return io('console/closeUserNotification', {'notification': notificationId}).then(function (response) {\n            // if (!response) return false;\n            hideItemLoadIndicator(notificationId + '_' + actionId, 'notification-action');\n            setProgress('notification_' + notificationId, false);\n            return removeNotification(notification.id);\n        });\n    } else if (notification.actions[actionId]) {\n        // TODO: Notification actions Here\n        return new Promise(function (resolve, reject) {\n            let action = notification.actions[actionId];\n            resolve(function () {\n                showItemLoadIndicator(notificationId + '_' + actionId, 'notification-action');\n                if (action.method) return action.method(action.parameters ? action.parameters : false);\n                return true;\n            }().then(function (result) {\n                if (!result) return result;\n                return action.closeAfter ? result : io('console/closeUserNotification', {'notification': notificationId})\n                    .then(function (response) {\n                        // hideItemLoadIndicator(notificationId + '_' + actionId, 'notification-action');\n                        // setProgress('notification_' + notificationId, false);\n                        return removeNotification(notification.id).then(function () {\n                            return result;\n                        });\n                    });\n            }).then(function () {\n                hideItemLoadIndicator(notificationId + '_' + actionId, 'notification-action');\n                setProgress('notification_' + notificationId, false);\n            }));\n        });\n\n    } else {\n        setProgress('notification_' + notificationId, false);\n        return false;\n    }\n}\n\nexport function removeNotification(notificationId) {\n    if (!notificationId) return false;\n    let notifications = document.querySelectorAll('[data-notification=\"' + notificationId + '\"]');\n    if (notifications && notifications.length > 0) /*for (let i in notifications) if (notifications[i]) notifications[i].parentNode.removeChild(notifications[i]);*/ notifications[0].parentNode.removeChild(notifications[0]);\n    if (pms.notification[notificationId]) {\n        pms.notification[notificationId] = false;\n        delete pms.notification[notificationId];\n    }\n    for (let i in pms.notifications) if (parseInt(pms.notifications[i].id) === parseInt(notificationId)) {\n        pms.notifications.splice(i, 1);\n        break;\n    }\n    return true;\n}\n\nexport function createNotification(title, body, icon, id, actions) {\n    /*actions = [\n        {\n            id: 'report',\n            title: 'Отчет',\n            method: reportPluginError,\n            parameters: {message: 'Error message', plugin: 12, time: new Date().getTime()}\n        }\n    ];*/\n    id = id ? (pms.notification[id] ? new Date().getTime() : id) : new Date().getTime();\n    let data = {\n        id: id,\n        title: title ? title : false,\n        body: body ? body : false,\n        icon: icon ? icon : false,\n        actions: actions ? actions : false,\n        // time: 'Сейчас',\n        local: true\n    };\n    pms.notification[id] = data;\n    return showNotification(data);\n}\n\nexport function showNotification(data) {\n    if (!pms.workspace.notificationsWrapper || !data) return false;\n    let notificationSource = '';\n    let notification = data;\n    if (!notification.id) return false;\n    notificationSource += '<div class=\"notification background-blur\" data-notification=\"' + notification.id + '\"><div class=\"notification-data\"><div class=\"notification-header\"><div class=\"notification-header-side\">';\n    if (notification.icon) notificationSource += '<figure style=\"background-image: url(' + notification.icon + ')\"></figure>';\n    if (notification.title) notificationSource += '<span>' + notification.title + '</span>';\n    notificationSource += '</div>';\n    if (notification.time) notificationSource += '<div class=\"notification-header-side\"><span>' + notification.time + '</span></div>';\n    notificationSource += '</div>';\n    if (notification.body) notificationSource += '<div class=\"notification-body\">' + notification.body + '</div>';\n    notificationSource += '</div><div class=\"notification-control\">';\n    if (notification.actions) {\n        for (let i in notification.actions) {\n            let action = notification.actions[i];\n            notificationSource += '<button class=\"notification-control-item\" data-notification-action=\"' + notification.id + '_' + i + '\" onclick=\"notifyAction(\\'' + notification.id + '\\',\\'' + i + '\\');\">' + action.title + '</button>';\n        }\n    } else notificationSource += '<button class=\"notification-control-item\" data-notification-action=\"' + notification.id + '_close\" onclick=\"notifyAction(\\'' + notification.id + '\\',\\'close\\');\">Закрыть</button>';\n    notificationSource += '</div></div>';\n    pms.workspace.notificationsWrapper.innerHTML += notificationSource;\n    return true;\n}\n\nfunction toggleMobileMenu(state) {\n    if (typeof state === \"boolean\") document.body.classList.toggle('mobile-menu-show', state);\n    else document.body.classList.toggle('mobile-menu-show');\n}\n\nexport function errorHandler(error, message, title, icon) {\n    console.error(message, error);\n    let actions = {\n        close: {\n            id: 'close',\n            title: 'Закрыть'\n        },\n        report: {\n            id: 'report',\n            title: 'Отчет',\n            method: errorReport,\n            parameters: error,\n            closeAfter: true\n        }\n    };\n    createNotification(\n        title ? title : 'Произошла ошибка!',\n        message ? message : error.message,\n        icon ? icon : pms.config.icon,\n        false, actions);\n    return true;\n}\n\nfunction errorReport(error) {\n    error = {\n        message: error.message,\n        stack: error.stack,\n        hostId: pms.selectedHost.id\n    };\n    return io('console/errorHandler', error).then(function (response) {\n        return response.status;\n    });\n}\n\nexport function initPromise(result) {\n    return new Promise(function (resolve, reject) {\n        return resolve(result);\n    });\n}","import * as workspace from './workspace.js';\nimport * as auth from './auth.js';\n\nwindow.pms = {\n    config: {\n        apiUrl: 'https://cms.prakula.ru/api/v1/',\n        name: 'PRakula CMS',\n        icon: '/pms-console/assets/images/logo.small.png'\n    }\n};\nwindow.io = io;\nwindow.oldIo = oldIo;\nwindow.initApp = initApp;\n// require('../css/style.css');\n\nwindow.addEventListener('load', function () {\n    pms.config.isFramed = false;\n    try {\n        pms.config.isFramed = window != window.top || document != top.document || self.location != top.location;\n    } catch (e) {\n        pms.config.isFramed = true;\n    }\n    if (pms.config.isFramed) {\n        window.addEventListener('message', function (event) {\n            if (window.initTimeout) clearTimeout(window.initTimeout);\n            delete window.initTimeout;\n            if (typeof event.data === 'object') window.pmsHostData = event.data;\n            initApp();\n        });\n        window.initTimeout = setTimeout(function () {\n            initApp();\n        }, 1000);\n        window.parent.postMessage({status: true, get: 'pmsHostData'}, '*');\n    } else initApp();\n});\n\nfunction initApp() {\n    if (window.pmsHostData) pms.currentHost = window.pmsHostData;\n    // console.debug(pms);\n    return auth.check().then(function (response) {\n        if (response) {\n            return workspace.prepare();\n        } else {\n            return auth.showLogin();\n        }\n    });\n}\n\nfunction oldIo(method, data, post, url, plainData) {\n    url = url ? url : (pms.config.apiUrl ? pms.config.apiUrl : '/api/') + method;\n    if (!post) {\n        data = data ? data : '';\n        if (typeof data === 'object') data = Object.keys(data).map(function (k) {\n            return encodeURIComponent(k) + '=' + encodeURIComponent(data[k]);\n        }).join('&');\n    }\n    if (method) {\n        let token = localStorage.getItem('token') ?\n            localStorage.getItem('token') : false;\n        /*(pms.currentHost ?\n            (pms.currentHost.token ? pms.currentHost.token : false) :\n            false);*/\n        if (token) {\n            if (post) data['_token'] = token; else data += (data !== '' ? '&' : '') + '_token=' + token;\n        }\n    }\n    if (data !== '' && !post) url += '?' + data;\n    let parameters = {\n        method: (post ? 'POST' : 'GET'),\n        mode: 'cors',\n        credentials: 'include'\n    };\n    if (post) parameters.body = JSON.stringify(data);\n    return fetch(url, parameters).then(function (response) {\n        if (response.status >= 200 && response.status < 300) {\n            return response\n        } else {\n            return plainData ? false : {'status': false, 'error': response.statusText};\n        }\n    }).then(function (response) {\n        if (!response) return response;\n        if (plainData) return response.text(); else return response.json();\n    }).catch(function (response) {\n        let debugData = ['Response parse error'];\n        if (response.message) debugData.push(response.message);\n        if (method) debugData.push(method);\n        if (data !== '') debugData.push(method ? decodeURIComponent(data) : decodeURIComponent(url));\n        console.debug.apply(this, debugData);\n        return {'status': false, 'error': 'Response parse error'};\n    }).then(function (response) {\n        if (!response || response.error) return response;\n        let debugData = [response.offline ? 'Offline mode' : 'Request successful'];\n        if (method) debugData.push(method);\n        if (data !== '') debugData.push(method ? decodeURIComponent(data) : decodeURIComponent(url));\n        debugData.push(response);\n        console.debug.apply(this, debugData);\n        if (response.offline) initOfflineMode(); else pms.offline = false;\n        return response;\n    }).catch(function (error) {\n        console.error(error);\n        return {'status': false};\n    });\n}\n\nfunction io(method, getData, postData, url, plainData) {\n    url = url ? url : (pms.config.apiUrl ? pms.config.apiUrl : '/api/') + method;\n    getData = getData ? getData : '';\n    if (typeof getData === 'object') getData = serialize(getData);\n    postData = postData ? postData : false;\n    if (typeof postData === 'object') postData = serialize(postData);\n    if (method && !getCookie('token')) {\n        let token = localStorage.getItem('token');\n        if (token) {\n            getData += (getData !== '' ? '&' : '') + '_token=' + token;\n        }\n    }\n    if (getData !== '') url += '?' + getData;\n    let parameters = {\n        method: (postData ? 'POST' : 'GET'),\n        mode: 'cors',\n        credentials: 'include'\n    };\n    if (postData) parameters.body = postData;\n    return fetch(url, parameters).then(function (response) {\n        if (response.status >= 200 && response.status < 300) {\n            return response\n        } else {\n            return plainData ? false : {'status': false, 'error': response.statusText};\n        }\n    }).then(function (response) {\n        if (!response) return response;\n        if (plainData) return response.text(); else return response.json();\n    }).catch(function (response) {\n        let debugData = ['Response parse error'];\n        if (response.message) debugData.push(response.message);\n        if (method) debugData.push(method);\n        if (getData !== '') debugData.push(method ? decodeURIComponent(getData) : decodeURIComponent(url));\n        if (postData && method) debugData.push(decodeURIComponent(postData));\n        console.debug.apply(this, debugData);\n        return {'status': false, 'error': 'Response parse error'};\n    }).then(function (response) {\n        if (!response || response.error) return response;\n        let debugData = [response.offline ? 'Offline mode' : 'Request successful'];\n        if (method) debugData.push(method);\n        if (getData !== '') debugData.push(method ? decodeURIComponent(getData) : decodeURIComponent(url));\n        if (postData && method) debugData.push(decodeURIComponent(postData));\n        debugData.push(response);\n        console.debug.apply(this, debugData);\n        if (response.offline) initOfflineMode(); else pms.offline = false;\n        return response;\n    }).catch(function (error) {\n        console.error(error);\n        return {'status': false};\n    });\n}\n\nfunction serialize(obj, prefix) {\n    var str = [], p;\n    for (p in obj) {\n        if (obj.hasOwnProperty(p)) {\n            var k = prefix ? prefix + \"[\" + p + \"]\" : p, v = obj[p];\n            str.push((v !== null && typeof v === \"object\") ?\n                serialize(v, k) :\n                encodeURIComponent(k) + \"=\" + encodeURIComponent(v));\n        }\n    }\n    return str.join(\"&\");\n}\n\nfunction getCookie(name) {\n    let matches = document.cookie.match(new RegExp(\n        \"(?:^|; )\" + name.replace(/([\\.$?*|{}\\(\\)\\[\\]\\\\\\/\\+^])/g, '\\\\$1') + \"=([^;]*)\"\n    ));\n    return matches ? decodeURIComponent(matches[1]) : undefined;\n}\n\nfunction initOfflineMode() {\n    if (pms.offline === true) return true;\n    pms.offline = true;\n    alert('Мы потеряли соединение с сервером, проверьте подключение и повторите');\n    return true\n}","import * as workspace from './workspace.js';\n\nlet template = {};\n\nwindow.auth = {logout: logout};\n\nexport function check() {\n    return io('console/getUserData').then(function (response) {\n        if (response.status) saveUserData(response);\n        return response.status;\n    });\n}\n\nexport function send(login, password) {\n    // auth.loginSection.classList.toggle('incorrect-data', false);\n    return new Promise(function (resolve, reject) {\n        if (!login || login === '') return resolve(loginError('empty_login', 'login'));\n        if (!login || password === '') return resolve(loginError('empty_password', 'password'));\n        showItemLoadIndicator('auth', 'login-button');\n        let data = {login: login, password: password};\n        return resolve(io('console/auth', data));\n    });\n}\n\n\nfunction loginError(message, type) {\n    // return new Promise(function (resolve, reject) {\n    let authLogin = document.getElementById('auth-login');\n    let loginMessage = document.getElementById('auth-login-message');\n    let authPassword = document.getElementById('auth-password');\n    let passwordMessage = document.getElementById('auth-password-message');\n    if (type) switch (type) {\n        case 'login':\n            switch (message) {\n                case 'empty_login':\n                    loginMessage.innerText = 'Необходимо ввести ваш логин';\n                    break;\n            }\n            authLogin.classList.toggle('highlight', true);\n            break;\n        case 'password':\n            switch (message) {\n                case 'empty_password':\n                    passwordMessage.innerText = 'Необходимо ввести ваш пароль';\n                    break;\n                case 'incorrect_data':\n                    passwordMessage.innerText = 'Указан неверный пароль';\n                    break;\n            }\n            authPassword.classList.toggle('highlight', true);\n            break;\n        case 'all':\n            switch (message) {\n                case 'bad_parameters':\n                    loginMessage.innerText = 'Необходимо ввести ваш логин';\n                    passwordMessage.innerText = 'Необходимо ввести ваш пароль';\n                    break;\n            }\n            authLogin.classList.toggle('highlight', true);\n            authPassword.classList.toggle('highlight', true);\n\n    }\n    hideItemLoadIndicator('auth', 'login-button');\n    setProgress('auth-button', false);\n    auth.loginSection.classList.toggle('incorrect-data', true);\n    setTimeout(function () {\n        auth.loginSection.classList.toggle('incorrect-data', false);\n    }, 500);\n    console.log(message ? message : type);\n    return false;// resolve(false);\n    // });\n}\n\nexport function showLogin() {\n    if (!template.login) return workspace.loadTemplate('login')\n        .then(function (response) {\n            if (!response) return 'Не удалось загрузить страницу';\n            return template.login = response;\n        }).then(workspace.render).then(prepareLogin); else\n        return workspace.render(template.login)\n            .then(prepareLogin);\n}\n\nfunction prepareLogin() {\n    if (pms.currentHost) {\n        if (pms.currentHost.title && document.getElementById('host-name')) document.getElementById('host-name').innerText = pms.currentHost.title;\n        if (pms.currentHost.logo && document.getElementById('host-logo')) document.getElementById('host-logo').src = pms.currentHost.logo;\n        if (pms.currentHost.homePage && document.getElementById('home-page')) document.getElementById('home-page').href = pms.currentHost.homePage;\n    }\n    if (document.getElementById('login-section')) auth.loginSection = document.getElementById('login-section');\n    if (document.getElementById('auth-button')) document.getElementById('auth-button').addEventListener('click', function () {\n        if (isProgress('auth-button')) return false;\n        if (!document.getElementById('auth-login') || !document.getElementById('auth-password')) return false;\n        document.getElementById('auth-login').classList.toggle('highlight', false);\n        document.getElementById('auth-login-message').innerText = '';\n        document.getElementById('auth-password').classList.toggle('highlight', false);\n        document.getElementById('auth-password-message').innerText = '';\n        setProgress('auth-button');\n        showLoadingIndicator();\n        return send(document.getElementById('auth-login').value, document.getElementById('auth-password').value).then(function (response) {\n            if (!response) return false;\n            if (!response.status) return loginError('incorrect_data', 'password');\n            if (response.token) {\n                localStorage.setItem('token', response.token);\n                /*if (pms.config.isFramed) window.parent.postMessage({\n                    status: true,\n                    set: 'token',\n                    data: response.token\n                }, '*');*/\n            }\n            pms.onLeavePage.push(function () {\n                hideItemLoadIndicator('auth', 'login-button');\n            });\n            saveUserData(response);\n            return workspace.prepare();\n        }).then(hideLoadingIndicator).then(function () {\n            return setProgress('auth-button', false);\n        });\n    });\n    return true;\n}\n\nfunction saveUserData(response) {\n    if (!response || !response.status) return false;\n    pms.userData = {};\n    if (response.userId) pms.userData.id = response.userId;\n    if (response.login) pms.userData.login = response.login;\n    if (response.email) pms.userData.email = response.email;\n    if (response.firstname) pms.userData.firstname = response.firstname;\n    if (response.lastname) pms.userData.lastname = response.lastname;\n    if (response.avamoji) pms.userData.avamoji = response.avamoji;\n\n    let OneSignal = window.OneSignal || [];\n    OneSignal.push([\"init\", {\n        appId: \"d6d3da7e-593f-4b75-a598-a5d4b27e31e6\",\n        autoRegister: true,\n        notifyButton: {\n            enable: false,\n        },\n        promptOptions: {\n            actionMessage: \"Уведомим о важных событиях связанных с сайтом, продвижением страниц и других изменениях\",\n            acceptButtonText: \"Получать\",\n            cancelButtonText: \"Отказаться\"\n        }\n    }]);\n    return true;\n}\n\nfunction logout() {\n    return io('console/logout').then(function (response) {\n        if (response && response.status) {\n            window.pms = {\n                config: pms.config\n            };\n            localStorage.clear();\n            return showLogin();\n        } else alert('Произошла ошибка');\n    })\n}"],"sourceRoot":""}